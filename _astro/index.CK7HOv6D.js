import{g as Ri}from"./_commonjsHelpers.BosuxZz1.js";import{r as W}from"./index.DtUoVs0J.js";const ot=function(e){return typeof e<"u"&&e!==null},Ii=function(e){return typeof e=="object"},Ai=function(e){return Object.prototype.toString.call(e)==="[object Object]"},ji=function(e){return typeof e=="function"},$i=function(e){return typeof e=="boolean"},Li=function(e){return e instanceof Buffer},Si=function(e){if(ot(e))switch(e.constructor){case Uint8Array:case Uint8ClampedArray:case Int8Array:case Uint16Array:case Int16Array:case Uint32Array:case Int32Array:case Float32Array:case Float64Array:return!0}return!1},Mi=function(e){return e instanceof ArrayBuffer},Ni=function(e){return typeof e=="string"&&e.length>0},Ti=function(e){return typeof e=="number"&&!Number.isNaN(e)},Ci=function(e){return Number.isInteger(e)},Bi=function(e,t,i){return e>=t&&e<=i},_i=function(e,t){return t.includes(e)},Fi=function(e,t,i){return new Error(`Expected ${t} for ${e} but received ${i} of type ${typeof i}`)},Di=function(e,t){return t.message=e.message,t};var H={defined:ot,object:Ii,plainObject:Ai,fn:ji,bool:$i,buffer:Li,typedArray:Si,arrayBuffer:Mi,string:Ni,number:Ti,integer:Ci,inRange:Bi,inArray:_i,invalidParameterError:Fi,nativeError:Di};function ee(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var at={exports:{}};const st=()=>process.platform==="linux";let ye=null;const zi=()=>{if(!ye)if(st()&&process.report){const e=process.report.excludeNetwork;process.report.excludeNetwork=!0,ye=process.report.getReport(),process.report.excludeNetwork=e}else ye={};return ye};var qi={isLinux:st,getReport:zi};const lt=W,Gi="/usr/bin/ldd",Ui=e=>lt.readFileSync(e,"utf-8"),Wi=e=>new Promise((t,i)=>{lt.readFile(e,"utf-8",(r,o)=>{r?i(r):t(o)})});var Hi={LDD_PATH:Gi,readFileSync:Ui,readFile:Wi};const ht=W,{isLinux:ae,getReport:ct}=qi,{LDD_PATH:Ee,readFile:pt,readFileSync:ut}=Hi;let D,z;const dt="getconf GNU_LIBC_VERSION 2>&1 || true; ldd --version 2>&1 || true";let te="";const ft=()=>te||new Promise(e=>{ht.exec(dt,(t,i)=>{te=t?" ":i,e(te)})}),mt=()=>{if(!te)try{te=ht.execSync(dt,{encoding:"utf8"})}catch{te=" "}return te},J="glibc",gt=/LIBC[a-z0-9 \-).]*?(\d+\.\d+)/i,se="musl",Xi=e=>e.includes("libc.musl-")||e.includes("ld-musl-"),bt=()=>{const e=ct();return e.header&&e.header.glibcVersionRuntime?J:Array.isArray(e.sharedObjects)&&e.sharedObjects.some(Xi)?se:null},wt=e=>{const[t,i]=e.split(/[\r\n]+/);return t&&t.includes(J)?J:i&&i.includes(se)?se:null},vt=e=>e.includes("musl")?se:e.includes("GNU C Library")?J:null,Qi=async()=>{if(D!==void 0)return D;D=null;try{const e=await pt(Ee);D=vt(e)}catch{}return D},Vi=()=>{if(D!==void 0)return D;D=null;try{const e=ut(Ee);D=vt(e)}catch{}return D},yt=async()=>{let e=null;if(ae()&&(e=await Qi(),e||(e=bt()),!e)){const t=await ft();e=wt(t)}return e},Et=()=>{let e=null;if(ae()&&(e=Vi(),e||(e=bt()),!e)){const t=mt();e=wt(t)}return e},Ji=async()=>ae()&&await yt()!==J,Yi=()=>ae()&&Et()!==J,Ki=async()=>{if(z!==void 0)return z;z=null;try{const e=(await pt(Ee)).match(gt);e&&(z=e[1])}catch{}return z},Zi=()=>{if(z!==void 0)return z;z=null;try{const e=ut(Ee).match(gt);e&&(z=e[1])}catch{}return z},xt=()=>{const e=ct();return e.header&&e.header.glibcVersionRuntime?e.header.glibcVersionRuntime:null},Pt=e=>e.trim().split(/\s+/)[1],Ot=e=>{const[t,i,r]=e.split(/[\r\n]+/);return t&&t.includes(J)?Pt(t):i&&r&&i.includes(se)?Pt(r):null},er=async()=>{let e=null;if(ae()&&(e=await Ki(),e||(e=xt()),!e)){const t=await ft();e=Ot(t)}return e},tr=()=>{let e=null;if(ae()&&(e=Zi(),e||(e=xt()),!e)){const t=mt();e=Ot(t)}return e};var _e={GLIBC:J,MUSL:se,family:yt,familySync:Et,isNonGlibcLinux:Ji,isNonGlibcLinuxSync:Yi,version:er,versionSync:tr},Fe={};const ir=typeof process=="object"&&Fe&&Fe.NODE_DEBUG&&/\bsemver\b/i.test(Fe.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var xe=ir;const rr="2.0.0",kt=256,nr=Number.MAX_SAFE_INTEGER||9007199254740991,or=16,ar=kt-6,sr=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var De={MAX_LENGTH:kt,MAX_SAFE_COMPONENT_LENGTH:or,MAX_SAFE_BUILD_LENGTH:ar,MAX_SAFE_INTEGER:nr,RELEASE_TYPES:sr,SEMVER_SPEC_VERSION:rr,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},ze={exports:{}};(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:o}=De,a=xe;t=e.exports={};const s=t.re=[],u=t.safeRe=[],l=t.src=[],p=t.t={};let b=0;const O="[a-zA-Z0-9-]",T=[["\\s",1],["\\d",o],[O,r]],Ce=U=>{for(const[F,V]of T)U=U.split(`${F}*`).join(`${F}{0,${V}}`).split(`${F}+`).join(`${F}{1,${V}}`);return U},x=(U,F,V)=>{const Be=Ce(F),L=b++;a(U,L,F),p[U]=L,l[L]=F,s[L]=new RegExp(F,V?"g":void 0),u[L]=new RegExp(Be,V?"g":void 0)};x("NUMERICIDENTIFIER","0|[1-9]\\d*"),x("NUMERICIDENTIFIERLOOSE","\\d+"),x("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${O}*`),x("MAINVERSION",`(${l[p.NUMERICIDENTIFIER]})\\.(${l[p.NUMERICIDENTIFIER]})\\.(${l[p.NUMERICIDENTIFIER]})`),x("MAINVERSIONLOOSE",`(${l[p.NUMERICIDENTIFIERLOOSE]})\\.(${l[p.NUMERICIDENTIFIERLOOSE]})\\.(${l[p.NUMERICIDENTIFIERLOOSE]})`),x("PRERELEASEIDENTIFIER",`(?:${l[p.NUMERICIDENTIFIER]}|${l[p.NONNUMERICIDENTIFIER]})`),x("PRERELEASEIDENTIFIERLOOSE",`(?:${l[p.NUMERICIDENTIFIERLOOSE]}|${l[p.NONNUMERICIDENTIFIER]})`),x("PRERELEASE",`(?:-(${l[p.PRERELEASEIDENTIFIER]}(?:\\.${l[p.PRERELEASEIDENTIFIER]})*))`),x("PRERELEASELOOSE",`(?:-?(${l[p.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[p.PRERELEASEIDENTIFIERLOOSE]})*))`),x("BUILDIDENTIFIER",`${O}+`),x("BUILD",`(?:\\+(${l[p.BUILDIDENTIFIER]}(?:\\.${l[p.BUILDIDENTIFIER]})*))`),x("FULLPLAIN",`v?${l[p.MAINVERSION]}${l[p.PRERELEASE]}?${l[p.BUILD]}?`),x("FULL",`^${l[p.FULLPLAIN]}$`),x("LOOSEPLAIN",`[v=\\s]*${l[p.MAINVERSIONLOOSE]}${l[p.PRERELEASELOOSE]}?${l[p.BUILD]}?`),x("LOOSE",`^${l[p.LOOSEPLAIN]}$`),x("GTLT","((?:<|>)?=?)"),x("XRANGEIDENTIFIERLOOSE",`${l[p.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),x("XRANGEIDENTIFIER",`${l[p.NUMERICIDENTIFIER]}|x|X|\\*`),x("XRANGEPLAIN",`[v=\\s]*(${l[p.XRANGEIDENTIFIER]})(?:\\.(${l[p.XRANGEIDENTIFIER]})(?:\\.(${l[p.XRANGEIDENTIFIER]})(?:${l[p.PRERELEASE]})?${l[p.BUILD]}?)?)?`),x("XRANGEPLAINLOOSE",`[v=\\s]*(${l[p.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[p.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[p.XRANGEIDENTIFIERLOOSE]})(?:${l[p.PRERELEASELOOSE]})?${l[p.BUILD]}?)?)?`),x("XRANGE",`^${l[p.GTLT]}\\s*${l[p.XRANGEPLAIN]}$`),x("XRANGELOOSE",`^${l[p.GTLT]}\\s*${l[p.XRANGEPLAINLOOSE]}$`),x("COERCEPLAIN",`(^|[^\\d])(\\d{1,${i}})(?:\\.(\\d{1,${i}}))?(?:\\.(\\d{1,${i}}))?`),x("COERCE",`${l[p.COERCEPLAIN]}(?:$|[^\\d])`),x("COERCEFULL",l[p.COERCEPLAIN]+`(?:${l[p.PRERELEASE]})?(?:${l[p.BUILD]})?(?:$|[^\\d])`),x("COERCERTL",l[p.COERCE],!0),x("COERCERTLFULL",l[p.COERCEFULL],!0),x("LONETILDE","(?:~>?)"),x("TILDETRIM",`(\\s*)${l[p.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",x("TILDE",`^${l[p.LONETILDE]}${l[p.XRANGEPLAIN]}$`),x("TILDELOOSE",`^${l[p.LONETILDE]}${l[p.XRANGEPLAINLOOSE]}$`),x("LONECARET","(?:\\^)"),x("CARETTRIM",`(\\s*)${l[p.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",x("CARET",`^${l[p.LONECARET]}${l[p.XRANGEPLAIN]}$`),x("CARETLOOSE",`^${l[p.LONECARET]}${l[p.XRANGEPLAINLOOSE]}$`),x("COMPARATORLOOSE",`^${l[p.GTLT]}\\s*(${l[p.LOOSEPLAIN]})$|^$`),x("COMPARATOR",`^${l[p.GTLT]}\\s*(${l[p.FULLPLAIN]})$|^$`),x("COMPARATORTRIM",`(\\s*)${l[p.GTLT]}\\s*(${l[p.LOOSEPLAIN]}|${l[p.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",x("HYPHENRANGE",`^\\s*(${l[p.XRANGEPLAIN]})\\s+-\\s+(${l[p.XRANGEPLAIN]})\\s*$`),x("HYPHENRANGELOOSE",`^\\s*(${l[p.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[p.XRANGEPLAINLOOSE]})\\s*$`),x("STAR","(<|>)?=?\\s*\\*"),x("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),x("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(ze,ze.exports);var Pe=ze.exports;const lr=Object.freeze({loose:!0}),hr=Object.freeze({}),cr=e=>e?typeof e!="object"?lr:e:hr;var qe=cr;const Rt=/^[0-9]+$/,It=(e,t)=>{const i=Rt.test(e),r=Rt.test(t);return i&&r&&(e=+e,t=+t),e===t?0:i&&!r?-1:r&&!i?1:e<t?-1:1},pr=(e,t)=>It(t,e);var ur={compareIdentifiers:It,rcompareIdentifiers:pr};const Oe=xe,{MAX_LENGTH:At,MAX_SAFE_INTEGER:ke}=De,{safeRe:jt,t:$t}=Pe,dr=qe,{compareIdentifiers:le}=ur;let fr=class G{constructor(t,i){if(i=dr(i),t instanceof G){if(t.loose===!!i.loose&&t.includePrerelease===!!i.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>At)throw new TypeError(`version is longer than ${At} characters`);Oe("SemVer",t,i),this.options=i,this.loose=!!i.loose,this.includePrerelease=!!i.includePrerelease;const r=t.trim().match(i.loose?jt[$t.LOOSE]:jt[$t.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>ke||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ke||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ke||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){const a=+o;if(a>=0&&a<ke)return a}return o}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(Oe("SemVer.compare",this.version,this.options,t),!(t instanceof G)){if(typeof t=="string"&&t===this.version)return 0;t=new G(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof G||(t=new G(t,this.options)),le(this.major,t.major)||le(this.minor,t.minor)||le(this.patch,t.patch)}comparePre(t){if(t instanceof G||(t=new G(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let i=0;do{const r=this.prerelease[i],o=t.prerelease[i];if(Oe("prerelease compare",i,r,o),r===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(r===void 0)return-1;if(r!==o)return le(r,o)}while(++i)}compareBuild(t){t instanceof G||(t=new G(t,this.options));let i=0;do{const r=this.build[i],o=t.build[i];if(Oe("build compare",i,r,o),r===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(r===void 0)return-1;if(r!==o)return le(r,o)}while(++i)}inc(t,i,r){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",i,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",i,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",i,r),this.inc("pre",i,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",i,r),this.inc("pre",i,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const o=Number(r)?1:0;if(!i&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[o];else{let a=this.prerelease.length;for(;--a>=0;)typeof this.prerelease[a]=="number"&&(this.prerelease[a]++,a=-2);if(a===-1){if(i===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(o)}}if(i){let a=[i,o];r===!1&&(a=[i]),le(this.prerelease[0],i)===0?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var ge=fr;const Lt=ge,mr=(e,t,i=!1)=>{if(e instanceof Lt)return e;try{return new Lt(e,t)}catch(r){if(!i)return null;throw r}};var gr=mr;const br=ge,wr=gr,{safeRe:Re,t:Ie}=Pe,vr=(e,t)=>{if(e instanceof br)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let i=null;if(!t.rtl)i=e.match(t.includePrerelease?Re[Ie.COERCEFULL]:Re[Ie.COERCE]);else{const l=t.includePrerelease?Re[Ie.COERCERTLFULL]:Re[Ie.COERCERTL];let p;for(;(p=l.exec(e))&&(!i||i.index+i[0].length!==e.length);)(!i||p.index+p[0].length!==i.index+i[0].length)&&(i=p),l.lastIndex=p.index+p[1].length+p[2].length;l.lastIndex=-1}if(i===null)return null;const r=i[2],o=i[3]||"0",a=i[4]||"0",s=t.includePrerelease&&i[5]?`-${i[5]}`:"",u=t.includePrerelease&&i[6]?`+${i[6]}`:"";return wr(`${r}.${o}.${a}${s}${u}`,t)};var yr=vr;const St=ge,Er=(e,t,i)=>new St(e,i).compare(new St(t,i));var he=Er;const xr=he,Pr=(e,t,i)=>xr(e,t,i)>=0;var Mt=Pr;class Or{constructor(){this.max=1e3,this.map=new Map}get(t){const i=this.map.get(t);if(i!==void 0)return this.map.delete(t),this.map.set(t,i),i}delete(t){return this.map.delete(t)}set(t,i){if(!this.delete(t)&&i!==void 0){if(this.map.size>=this.max){const r=this.map.keys().next().value;this.delete(r)}this.map.set(t,i)}return this}}var kr=Or;const Rr=he,Ir=(e,t,i)=>Rr(e,t,i)===0;var Ar=Ir;const jr=he,$r=(e,t,i)=>jr(e,t,i)!==0;var Lr=$r;const Sr=he,Mr=(e,t,i)=>Sr(e,t,i)>0;var Nr=Mr;const Tr=he,Cr=(e,t,i)=>Tr(e,t,i)<0;var Br=Cr;const _r=he,Fr=(e,t,i)=>_r(e,t,i)<=0;var Dr=Fr;const zr=Ar,qr=Lr,Gr=Nr,Ur=Mt,Wr=Br,Hr=Dr,Xr=(e,t,i,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof i=="object"&&(i=i.version),e===i;case"!==":return typeof e=="object"&&(e=e.version),typeof i=="object"&&(i=i.version),e!==i;case"":case"=":case"==":return zr(e,i,r);case"!=":return qr(e,i,r);case">":return Gr(e,i,r);case">=":return Ur(e,i,r);case"<":return Wr(e,i,r);case"<=":return Hr(e,i,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var Qr=Xr,Ge,Nt;function Vr(){if(Nt)return Ge;Nt=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(b,O){if(O=i(O),b instanceof t){if(b.loose===!!O.loose)return b;b=b.value}b=b.trim().split(/\s+/).join(" "),s("comparator",b,O),this.options=O,this.loose=!!O.loose,this.parse(b),this.semver===e?this.value="":this.value=this.operator+this.semver.version,s("comp",this)}parse(b){const O=this.options.loose?r[o.COMPARATORLOOSE]:r[o.COMPARATOR],T=b.match(O);if(!T)throw new TypeError(`Invalid comparator: ${b}`);this.operator=T[1]!==void 0?T[1]:"",this.operator==="="&&(this.operator=""),T[2]?this.semver=new u(T[2],this.options.loose):this.semver=e}toString(){return this.value}test(b){if(s("Comparator.test",b,this.options.loose),this.semver===e||b===e)return!0;if(typeof b=="string")try{b=new u(b,this.options)}catch{return!1}return a(b,this.operator,this.semver,this.options)}intersects(b,O){if(!(b instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new l(b.value,O).test(this.value):b.operator===""?b.value===""?!0:new l(this.value,O).test(b.semver):(O=i(O),O.includePrerelease&&(this.value==="<0.0.0-0"||b.value==="<0.0.0-0")||!O.includePrerelease&&(this.value.startsWith("<0.0.0")||b.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&b.operator.startsWith(">")||this.operator.startsWith("<")&&b.operator.startsWith("<")||this.semver.version===b.semver.version&&this.operator.includes("=")&&b.operator.includes("=")||a(this.semver,"<",b.semver,O)&&this.operator.startsWith(">")&&b.operator.startsWith("<")||a(this.semver,">",b.semver,O)&&this.operator.startsWith("<")&&b.operator.startsWith(">")))}}Ge=t;const i=qe,{safeRe:r,t:o}=Pe,a=Qr,s=xe,u=ge,l=Ct();return Ge}var Ue,Tt;function Ct(){if(Tt)return Ue;Tt=1;const e=/\s+/g;class t{constructor(d,y){if(y=o(y),d instanceof t)return d.loose===!!y.loose&&d.includePrerelease===!!y.includePrerelease?d:new t(d.raw,y);if(d instanceof a)return this.raw=d.value,this.set=[[d]],this.formatted=void 0,this;if(this.options=y,this.loose=!!y.loose,this.includePrerelease=!!y.includePrerelease,this.raw=d.trim().replace(e," "),this.set=this.raw.split("||").map(w=>this.parseRange(w.trim())).filter(w=>w.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const w=this.set[0];if(this.set=this.set.filter(E=>!U(E[0])),this.set.length===0)this.set=[w];else if(this.set.length>1){for(const E of this.set)if(E.length===1&&F(E[0])){this.set=[E];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let d=0;d<this.set.length;d++){d>0&&(this.formatted+="||");const y=this.set[d];for(let w=0;w<y.length;w++)w>0&&(this.formatted+=" "),this.formatted+=y[w].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(d){const y=((this.options.includePrerelease&&Ce)|(this.options.loose&&x))+":"+d,w=r.get(y);if(w)return w;const E=this.options.loose,v=E?l[p.HYPHENRANGELOOSE]:l[p.HYPHENRANGE];d=d.replace(v,Oi(this.options.includePrerelease)),s("hyphen replace",d),d=d.replace(l[p.COMPARATORTRIM],b),s("comparator trim",d),d=d.replace(l[p.TILDETRIM],O),s("tilde trim",d),d=d.replace(l[p.CARETTRIM],T),s("caret trim",d);let P=d.split(" ").map(j=>Be(j,this.options)).join(" ").split(/\s+/).map(j=>Pi(j,this.options));E&&(P=P.filter(j=>(s("loose invalid filter",j,this.options),!!j.match(l[p.COMPARATORLOOSE])))),s("range list",P);const R=new Map,k=P.map(j=>new a(j,this.options));for(const j of k){if(U(j))return[j];R.set(j.value,j)}R.size>1&&R.has("")&&R.delete("");const A=[...R.values()];return r.set(y,A),A}intersects(d,y){if(!(d instanceof t))throw new TypeError("a Range is required");return this.set.some(w=>V(w,y)&&d.set.some(E=>V(E,y)&&w.every(v=>E.every(P=>v.intersects(P,y)))))}test(d){if(!d)return!1;if(typeof d=="string")try{d=new u(d,this.options)}catch{return!1}for(let y=0;y<this.set.length;y++)if(ki(this.set[y],d,this.options))return!0;return!1}}Ue=t;const i=kr,r=new i,o=qe,a=Vr(),s=xe,u=ge,{safeRe:l,t:p,comparatorTrimReplace:b,tildeTrimReplace:O,caretTrimReplace:T}=Pe,{FLAG_INCLUDE_PRERELEASE:Ce,FLAG_LOOSE:x}=De,U=f=>f.value==="<0.0.0-0",F=f=>f.value==="",V=(f,d)=>{let y=!0;const w=f.slice();let E=w.pop();for(;y&&w.length;)y=w.every(v=>E.intersects(v,d)),E=w.pop();return y},Be=(f,d)=>(s("comp",f,d),f=wi(f,d),s("caret",f),f=gi(f,d),s("tildes",f),f=yi(f,d),s("xrange",f),f=xi(f,d),s("stars",f),f),L=f=>!f||f.toLowerCase()==="x"||f==="*",gi=(f,d)=>f.trim().split(/\s+/).map(y=>bi(y,d)).join(" "),bi=(f,d)=>{const y=d.loose?l[p.TILDELOOSE]:l[p.TILDE];return f.replace(y,(w,E,v,P,R)=>{s("tilde",f,w,E,v,P,R);let k;return L(E)?k="":L(v)?k=`>=${E}.0.0 <${+E+1}.0.0-0`:L(P)?k=`>=${E}.${v}.0 <${E}.${+v+1}.0-0`:R?(s("replaceTilde pr",R),k=`>=${E}.${v}.${P}-${R} <${E}.${+v+1}.0-0`):k=`>=${E}.${v}.${P} <${E}.${+v+1}.0-0`,s("tilde return",k),k})},wi=(f,d)=>f.trim().split(/\s+/).map(y=>vi(y,d)).join(" "),vi=(f,d)=>{s("caret",f,d);const y=d.loose?l[p.CARETLOOSE]:l[p.CARET],w=d.includePrerelease?"-0":"";return f.replace(y,(E,v,P,R,k)=>{s("caret",f,E,v,P,R,k);let A;return L(v)?A="":L(P)?A=`>=${v}.0.0${w} <${+v+1}.0.0-0`:L(R)?v==="0"?A=`>=${v}.${P}.0${w} <${v}.${+P+1}.0-0`:A=`>=${v}.${P}.0${w} <${+v+1}.0.0-0`:k?(s("replaceCaret pr",k),v==="0"?P==="0"?A=`>=${v}.${P}.${R}-${k} <${v}.${P}.${+R+1}-0`:A=`>=${v}.${P}.${R}-${k} <${v}.${+P+1}.0-0`:A=`>=${v}.${P}.${R}-${k} <${+v+1}.0.0-0`):(s("no pr"),v==="0"?P==="0"?A=`>=${v}.${P}.${R}${w} <${v}.${P}.${+R+1}-0`:A=`>=${v}.${P}.${R}${w} <${v}.${+P+1}.0-0`:A=`>=${v}.${P}.${R} <${+v+1}.0.0-0`),s("caret return",A),A})},yi=(f,d)=>(s("replaceXRanges",f,d),f.split(/\s+/).map(y=>Ei(y,d)).join(" ")),Ei=(f,d)=>{f=f.trim();const y=d.loose?l[p.XRANGELOOSE]:l[p.XRANGE];return f.replace(y,(w,E,v,P,R,k)=>{s("xRange",f,w,E,v,P,R,k);const A=L(v),j=A||L(P),oe=j||L(R),me=oe;return E==="="&&me&&(E=""),k=d.includePrerelease?"-0":"",A?E===">"||E==="<"?w="<0.0.0-0":w="*":E&&me?(j&&(P=0),R=0,E===">"?(E=">=",j?(v=+v+1,P=0,R=0):(P=+P+1,R=0)):E==="<="&&(E="<",j?v=+v+1:P=+P+1),E==="<"&&(k="-0"),w=`${E+v}.${P}.${R}${k}`):j?w=`>=${v}.0.0${k} <${+v+1}.0.0-0`:oe&&(w=`>=${v}.${P}.0${k} <${v}.${+P+1}.0-0`),s("xRange return",w),w})},xi=(f,d)=>(s("replaceStars",f,d),f.trim().replace(l[p.STAR],"")),Pi=(f,d)=>(s("replaceGTE0",f,d),f.trim().replace(l[d.includePrerelease?p.GTE0PRE:p.GTE0],"")),Oi=f=>(d,y,w,E,v,P,R,k,A,j,oe,me)=>(L(w)?y="":L(E)?y=`>=${w}.0.0${f?"-0":""}`:L(v)?y=`>=${w}.${E}.0${f?"-0":""}`:P?y=`>=${y}`:y=`>=${y}${f?"-0":""}`,L(A)?k="":L(j)?k=`<${+A+1}.0.0-0`:L(oe)?k=`<${A}.${+j+1}.0-0`:me?k=`<=${A}.${j}.${oe}-${me}`:f?k=`<${A}.${j}.${+oe+1}-0`:k=`<=${k}`,`${y} ${k}`.trim()),ki=(f,d,y)=>{for(let w=0;w<f.length;w++)if(!f[w].test(d))return!1;if(d.prerelease.length&&!y.includePrerelease){for(let w=0;w<f.length;w++)if(s(f[w].semver),f[w].semver!==a.ANY&&f[w].semver.prerelease.length>0){const E=f[w].semver;if(E.major===d.major&&E.minor===d.minor&&E.patch===d.patch)return!0}return!1}return!0};return Ue}const Jr=Ct(),Yr=(e,t,i)=>{try{t=new Jr(t,i)}catch{return!1}return t.test(e)};var Kr=Yr;const Zr="sharp",en="High performance Node.js image processing, the fastest module to resize JPEG, PNG, WebP, GIF, AVIF and TIFF images",tn="0.33.5",rn="Lovell Fuller <npm@lovell.info>",nn="https://sharp.pixelplumbing.com",on=["Pierre Inglebert <pierre.inglebert@gmail.com>","Jonathan Ong <jonathanrichardong@gmail.com>","Chanon Sajjamanochai <chanon.s@gmail.com>","Juliano Julio <julianojulio@gmail.com>","Daniel Gasienica <daniel@gasienica.ch>","Julian Walker <julian@fiftythree.com>","Amit Pitaru <pitaru.amit@gmail.com>","Brandon Aaron <hello.brandon@aaron.sh>","Andreas Lind <andreas@one.com>","Maurus Cuelenaere <mcuelenaere@gmail.com>","Linus Unneb\xE4ck <linus@folkdatorn.se>","Victor Mateevitsi <mvictoras@gmail.com>","Alaric Holloway <alaric.holloway@gmail.com>","Bernhard K. Weisshuhn <bkw@codingforce.com>","Chris Riley <criley@primedia.com>","David Carley <dacarley@gmail.com>","John Tobin <john@limelightmobileinc.com>","Kenton Gray <kentongray@gmail.com>","Felix B\xFCnemann <Felix.Buenemann@gmail.com>","Samy Al Zahrani <samyalzahrany@gmail.com>","Chintan Thakkar <lemnisk8@gmail.com>","F. Orlando Galashan <frulo@gmx.de>","Kleis Auke Wolthuizen <info@kleisauke.nl>","Matt Hirsch <mhirsch@media.mit.edu>","Matthias Thoemmes <thoemmes@gmail.com>","Patrick Paskaris <patrick@paskaris.gr>","J\xE9r\xE9my Lal <kapouer@melix.org>","Rahul Nanwani <r.nanwani@gmail.com>","Alice Monday <alice0meta@gmail.com>","Kristo Jorgenson <kristo.jorgenson@gmail.com>","YvesBos <yves_bos@outlook.com>","Guy Maliar <guy@tailorbrands.com>","Nicolas Coden <nicolas@ncoden.fr>","Matt Parrish <matt.r.parrish@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Matthew McEachen <matthew+github@mceachen.org>","Jarda Kot\u011B\u0161ovec <jarda.kotesovec@gmail.com>","Kenric D'Souza <kenric.dsouza@gmail.com>","Oleh Aleinyk <oleg.aleynik@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Andrea Bianco <andrea.bianco@unibas.ch>","Rik Heywood <rik@rik.org>","Thomas Parisot <hi@oncletom.io>","Nathan Graves <nathanrgraves+github@gmail.com>","Tom Lokhorst <tom@lokhorst.eu>","Espen Hovlandsdal <espen@hovlandsdal.com>","Sylvain Dumont <sylvain.dumont35@gmail.com>","Alun Davies <alun.owain.davies@googlemail.com>","Aidan Hoolachan <ajhoolachan21@gmail.com>","Axel Eirola <axel.eirola@iki.fi>","Freezy <freezy@xbmc.org>","Daiz <taneli.vatanen@gmail.com>","Julian Aubourg <j@ubourg.net>","Keith Belovay <keith@picthrive.com>","Michael B. Klein <mbklein@gmail.com>","Jordan Prudhomme <jordan@raboland.fr>","Ilya Ovdin <iovdin@gmail.com>","Andargor <andargor@yahoo.com>","Paul Neave <paul.neave@gmail.com>","Brendan Kennedy <brenwken@gmail.com>","Brychan Bennett-Odlum <git@brychan.io>","Edward Silverton <e.silverton@gmail.com>","Roman Malieiev <aromaleev@gmail.com>","Tomas Szabo <tomas.szabo@deftomat.com>","Robert O'Rourke <robert@o-rourke.org>","Guillermo Alfonso Varela Chouci\xF1o <guillevch@gmail.com>","Christian Flintrup <chr@gigahost.dk>","Manan Jadhav <manan@motionden.com>","Leon Radley <leon@radley.se>","alza54 <alza54@thiocod.in>","Jacob Smith <jacob@frende.me>","Michael Nutt <michael@nutt.im>","Brad Parham <baparham@gmail.com>","Taneli Vatanen <taneli.vatanen@gmail.com>","Joris Dugu\xE9 <zaruike10@gmail.com>","Chris Banks <christopher.bradley.banks@gmail.com>","Ompal Singh <ompal.hitm09@gmail.com>","Brodan <christopher.hranj@gmail.com>","Ankur Parihar <ankur.github@gmail.com>","Brahim Ait elhaj <brahima@gmail.com>","Mart Jansink <m.jansink@gmail.com>","Lachlan Newman <lachnewman007@gmail.com>","Dennis Beatty <dennis@dcbeatty.com>","Ingvar Stepanyan <me@rreverser.com>","Don Denton <don@happycollision.com>"],an={install:"node install/check",clean:"rm -rf src/build/ .nyc_output/ coverage/ test/fixtures/output.*",test:"npm run test-lint && npm run test-unit && npm run test-licensing && npm run test-types","test-lint":"semistandard && cpplint","test-unit":"nyc --reporter=lcov --reporter=text --check-coverage --branches=100 mocha","test-licensing":'license-checker --production --summary --onlyAllow="Apache-2.0;BSD;ISC;LGPL-3.0-or-later;MIT"',"test-leak":"./test/leak/leak.sh","test-types":"tsd","package-from-local-build":"node npm/from-local-build","package-from-github-release":"node npm/from-github-release","docs-build":"node docs/build && node docs/search-index/build","docs-serve":"cd docs && npx serve","docs-publish":"cd docs && npx firebase-tools deploy --project pixelplumbing --only hosting:pixelplumbing-sharp"},sn="commonjs",ln="lib/index.js",hn="lib/index.d.ts",cn=["install","lib","src/*.{cc,h,gyp}"],pn={type:"git",url:"git://github.com/lovell/sharp.git"},un=["jpeg","png","webp","avif","tiff","gif","svg","jp2","dzi","image","resize","thumbnail","crop","embed","libvips","vips"],dn={color:"^4.2.3","detect-libc":"^2.0.3",semver:"^7.6.3"},fn={"@img/sharp-darwin-arm64":"0.33.5","@img/sharp-darwin-x64":"0.33.5","@img/sharp-libvips-darwin-arm64":"1.0.4","@img/sharp-libvips-darwin-x64":"1.0.4","@img/sharp-libvips-linux-arm":"1.0.5","@img/sharp-libvips-linux-arm64":"1.0.4","@img/sharp-libvips-linux-s390x":"1.0.4","@img/sharp-libvips-linux-x64":"1.0.4","@img/sharp-libvips-linuxmusl-arm64":"1.0.4","@img/sharp-libvips-linuxmusl-x64":"1.0.4","@img/sharp-linux-arm":"0.33.5","@img/sharp-linux-arm64":"0.33.5","@img/sharp-linux-s390x":"0.33.5","@img/sharp-linux-x64":"0.33.5","@img/sharp-linuxmusl-arm64":"0.33.5","@img/sharp-linuxmusl-x64":"0.33.5","@img/sharp-wasm32":"0.33.5","@img/sharp-win32-ia32":"0.33.5","@img/sharp-win32-x64":"0.33.5"},mn={"@emnapi/runtime":"^1.2.0","@img/sharp-libvips-dev":"1.0.4","@img/sharp-libvips-dev-wasm32":"1.0.5","@img/sharp-libvips-win32-ia32":"1.0.4","@img/sharp-libvips-win32-x64":"1.0.4","@types/node":"*",async:"^3.2.5",cc:"^3.0.1",emnapi:"^1.2.0","exif-reader":"^2.0.1","extract-zip":"^2.0.1",icc:"^3.0.0","jsdoc-to-markdown":"^8.0.3","license-checker":"^25.0.1",mocha:"^10.7.3","node-addon-api":"^8.1.0",nyc:"^17.0.0",prebuild:"^13.0.1",semistandard:"^17.0.0","tar-fs":"^3.0.6",tsd:"^0.31.1"},gn="Apache-2.0",bn={node:"^18.17.0 || ^20.3.0 || >=21.0.0"},wn={libvips:">=8.15.3"},vn={url:"https://opencollective.com/libvips"},yn={napi_versions:[9]},En={env:["mocha"]},xn={linelength:"120",filter:["build/include"]},Pn={include:["lib"]},On={directory:"test/types/"},Bt={name:Zr,description:en,version:tn,author:rn,homepage:nn,contributors:on,scripts:an,type:sn,main:ln,types:hn,files:cn,repository:pn,keywords:un,dependencies:dn,optionalDependencies:fn,devDependencies:mn,license:gn,engines:bn,config:wn,funding:vn,binary:yn,semistandard:En,cc:xn,nyc:Pn,tsd:On};var ie={};const{spawnSync:Ae}=W,{createHash:kn}=W,_t=yr,Rn=Mt,In=Kr,Ft=_e,{config:An,engines:Dt,optionalDependencies:jn}=Bt,$n=ie.npm_package_config_libvips||An.libvips,zt=_t($n).version,Ln=["darwin-arm64","darwin-x64","linux-arm","linux-arm64","linux-s390x","linux-x64","linuxmusl-arm64","linuxmusl-x64","win32-ia32","win32-x64"],je={encoding:"utf8",shell:!0},Sn=e=>{e instanceof Error?console.error(`sharp: Installation error: ${e.message}`):console.log(`sharp: ${e}`)},qt=()=>Ft.isNonGlibcLinuxSync()?Ft.familySync():"",Mn=()=>`${process.platform}${qt()}-${process.arch}`,ce=()=>{if(Gt())return"wasm32";const{npm_config_arch:e,npm_config_platform:t,npm_config_libc:i}=ie,r=typeof i=="string"?i:qt();return`${t||process.platform}${r}-${e||process.arch}`},Nn=()=>{try{return ee(`@img/sharp-libvips-dev-${ce()}/include`)}catch{try{return require("@img/sharp-libvips-dev/include")}catch{}}return""},Tn=()=>{try{return require("@img/sharp-libvips-dev/cplusplus")}catch{}return""},Cn=()=>{try{return ee(`@img/sharp-libvips-dev-${ce()}/lib`)}catch{try{return ee(`@img/sharp-libvips-${ce()}/lib`)}catch{}}return""},Bn=()=>{var e;if(((e=process.release)==null?void 0:e.name)==="node"&&process.versions&&!In(process.versions.node,Dt.node))return{found:process.versions.node,expected:Dt.node}},Gt=()=>{const{CC:e}=ie;return!!(e&&e.endsWith("/emcc"))},_n=()=>process.platform==="darwin"&&process.arch==="x64"?(Ae("sysctl sysctl.proc_translated",je).stdout||"").trim()==="sysctl.proc_translated: 1":!1,Ut=e=>kn("sha512").update(e).digest("hex"),Fn=()=>{try{const e=Ut(`imgsharp-libvips-${ce()}`),t=_t(jn[`@img/sharp-libvips-${ce()}`]).version;return Ut(`${e}npm:${t}`).slice(0,10)}catch{}return""},Dn=()=>Ae(`node-gyp rebuild --directory=src ${Gt()?"--nodedir=emscripten":""}`,{...je,stdio:"inherit"}).status,Wt=()=>process.platform!=="win32"?(Ae("pkg-config --modversion vips-cpp",{...je,env:{...ie,PKG_CONFIG_PATH:Ht()}}).stdout||"").trim():"",Ht=()=>process.platform!=="win32"?[(Ae('which brew >/dev/null 2>&1 && brew environment --plain | grep PKG_CONFIG_LIBDIR | cut -d" " -f2',je).stdout||"").trim(),ie.PKG_CONFIG_PATH,"/usr/local/lib/pkgconfig","/usr/lib/pkgconfig","/usr/local/libdata/pkgconfig","/usr/libdata/pkgconfig"].filter(Boolean).join(":"):"",We=(e,t,i)=>(i&&i(`Detected ${t}, skipping search for globally-installed libvips`),e),zn=e=>{if(ie.SHARP_IGNORE_GLOBAL_LIBVIPS)return We(!1,"SHARP_IGNORE_GLOBAL_LIBVIPS",e);if(ie.SHARP_FORCE_GLOBAL_LIBVIPS)return We(!0,"SHARP_FORCE_GLOBAL_LIBVIPS",e);if(_n())return We(!1,"Rosetta",e);const t=Wt();return!!t&&Rn(t,zt)};var Xt={minimumLibvipsVersion:zt,prebuiltPlatforms:Ln,buildPlatformArch:ce,buildSharpLibvipsIncludeDir:Nn,buildSharpLibvipsCPlusPlusDir:Tn,buildSharpLibvipsLibDir:Cn,isUnsupportedNodeRuntime:Bn,runtimePlatformArch:Mn,log:Sn,yarnLocator:Fn,spawnRebuild:Dn,globalLibvipsVersion:Wt,pkgConfigPath:Ht,useGlobalLibvips:zn};const{familySync:qn,versionSync:Gn}=_e,{runtimePlatformArch:Un,isUnsupportedNodeRuntime:Qt,prebuiltPlatforms:Wn,minimumLibvipsVersion:Hn}=Xt,re=Un(),Xn=[`../src/build/Release/sharp-${re}.node`,"../src/build/Release/sharp-wasm32.node",`@img/sharp-${re}/sharp.node`,"@img/sharp-wasm32/sharp.node"];let He;const $e=[];for(const e of Xn)try{He=ee(e);break}catch(t){$e.push(t)}if(He)at.exports=He;else{const[e,t,i]=["linux","darwin","win32"].map(a=>re.startsWith(a)),r=[`Could not load the "sharp" module using the ${re} runtime`];$e.forEach(a=>{a.code!=="MODULE_NOT_FOUND"&&r.push(`${a.code}: ${a.message}`)});const o=$e.map(a=>a.message).join(" ");if(r.push("Possible solutions:"),Qt()){const{found:a,expected:s}=Qt();r.push("- Please upgrade Node.js:",`    Found ${a}`,`    Requires ${s}`)}else if(Wn.includes(re)){const[a,s]=re.split("-"),u=a.endsWith("musl")?" --libc=musl":"";r.push("- Ensure optional dependencies can be installed:","    npm install --include=optional sharp","- Ensure your package manager supports multi-platform installation:","    See https://sharp.pixelplumbing.com/install#cross-platform","- Add platform-specific dependencies:",`    npm install --os=${a.replace("musl","")}${u} --cpu=${s} sharp`)}else r.push(`- Manually install libvips >= ${Hn}`,"- Add experimental WebAssembly-based dependencies:","    npm install --cpu=wasm32 sharp","    npm install @img/sharp-wasm32");if(e&&/(symbol not found|CXXABI_)/i.test(o))try{const{config:a}=ee(`@img/sharp-libvips-${re}/package`),s=`${qn()} ${Gn()}`,u=`${a.musl?"musl":"glibc"} ${a.musl||a.glibc}`;r.push("- Update your OS:",`    Found ${s}`,`    Requires ${u}`)}catch{}throw e&&/\/snap\/core[0-9]{2}/.test(o)&&r.push("- Remove the Node.js Snap, which does not support native modules","    snap remove node"),t&&/Incompatible library version/.test(o)&&r.push("- Update Homebrew:","    brew update && brew upgrade vips"),$e.some(a=>a.code==="ERR_DLOPEN_DISABLED")&&r.push("- Run Node.js without using the --no-addons flag"),i&&/The specified procedure could not be found/.test(o)&&r.push("- Using the canvas package on Windows?","    See https://sharp.pixelplumbing.com/install#canvas-and-windows","- Check for outdated versions of sharp in the dependency tree:","    npm ls sharp"),r.push("- Consult the installation documentation:","    See https://sharp.pixelplumbing.com/install"),new Error(r.join(`
`))}var Xe=at.exports;const Qn=W,Qe=W,Vn=H,Jn=Qn.debuglog("sharp"),ne=function(e,t){if(arguments.length===1&&!Vn.defined(e))throw new Error("Invalid input");return this instanceof ne?(Qe.Duplex.call(this),this.options={topOffsetPre:-1,leftOffsetPre:-1,widthPre:-1,heightPre:-1,topOffsetPost:-1,leftOffsetPost:-1,widthPost:-1,heightPost:-1,width:-1,height:-1,canvas:"crop",position:0,resizeBackground:[0,0,0,255],useExifOrientation:!1,angle:0,rotationAngle:0,rotationBackground:[0,0,0,255],rotateBeforePreExtract:!1,flip:!1,flop:!1,extendTop:0,extendBottom:0,extendLeft:0,extendRight:0,extendBackground:[0,0,0,255],extendWith:"background",withoutEnlargement:!1,withoutReduction:!1,affineMatrix:[],affineBackground:[0,0,0,255],affineIdx:0,affineIdy:0,affineOdx:0,affineOdy:0,affineInterpolator:this.constructor.interpolators.bilinear,kernel:"lanczos3",fastShrinkOnLoad:!0,tint:[-1,0,0,0],flatten:!1,flattenBackground:[0,0,0],unflatten:!1,negate:!1,negateAlpha:!0,medianSize:0,blurSigma:0,precision:"integer",minAmpl:.2,sharpenSigma:0,sharpenM1:1,sharpenM2:2,sharpenX1:2,sharpenY2:10,sharpenY3:20,threshold:0,thresholdGrayscale:!0,trimBackground:[],trimThreshold:-1,trimLineArt:!1,gamma:0,gammaOut:0,greyscale:!1,normalise:!1,normaliseLower:1,normaliseUpper:99,claheWidth:0,claheHeight:0,claheMaxSlope:3,brightness:1,saturation:1,hue:0,lightness:0,booleanBufferIn:null,booleanFileIn:"",joinChannelIn:[],extractChannel:-1,removeAlpha:!1,ensureAlpha:-1,colourspace:"srgb",colourspacePipeline:"last",composite:[],fileOut:"",formatOut:"input",streamOut:!1,keepMetadata:0,withMetadataOrientation:-1,withMetadataDensity:0,withIccProfile:"",withExif:{},withExifMerge:!0,resolveWithObject:!1,jpegQuality:80,jpegProgressive:!1,jpegChromaSubsampling:"4:2:0",jpegTrellisQuantisation:!1,jpegOvershootDeringing:!1,jpegOptimiseScans:!1,jpegOptimiseCoding:!0,jpegQuantisationTable:0,pngProgressive:!1,pngCompressionLevel:6,pngAdaptiveFiltering:!1,pngPalette:!1,pngQuality:100,pngEffort:7,pngBitdepth:8,pngDither:1,jp2Quality:80,jp2TileHeight:512,jp2TileWidth:512,jp2Lossless:!1,jp2ChromaSubsampling:"4:4:4",webpQuality:80,webpAlphaQuality:100,webpLossless:!1,webpNearLossless:!1,webpSmartSubsample:!1,webpPreset:"default",webpEffort:4,webpMinSize:!1,webpMixed:!1,gifBitdepth:8,gifEffort:7,gifDither:1,gifInterFrameMaxError:0,gifInterPaletteMaxError:3,gifReuse:!0,gifProgressive:!1,tiffQuality:80,tiffCompression:"jpeg",tiffPredictor:"horizontal",tiffPyramid:!1,tiffMiniswhite:!1,tiffBitdepth:8,tiffTile:!1,tiffTileHeight:256,tiffTileWidth:256,tiffXres:1,tiffYres:1,tiffResolutionUnit:"inch",heifQuality:50,heifLossless:!1,heifCompression:"av1",heifEffort:4,heifChromaSubsampling:"4:4:4",heifBitdepth:8,jxlDistance:1,jxlDecodingTier:0,jxlEffort:7,jxlLossless:!1,rawDepth:"uchar",tileSize:256,tileOverlap:0,tileContainer:"fs",tileLayout:"dz",tileFormat:"last",tileDepth:"last",tileAngle:0,tileSkipBlanks:-1,tileBackground:[255,255,255,255],tileCentre:!1,tileId:"https://example.com/iiif",tileBasename:"",timeoutSeconds:0,linearA:[],linearB:[],debuglog:i=>{this.emit("warning",i),Jn(i)},queueListener:function(i){ne.queue.emit("change",i)}},this.options.input=this._createInputDescriptor(e,t,{allowStream:!0}),this):new ne(e,t)};Object.setPrototypeOf(ne.prototype,Qe.Duplex.prototype),Object.setPrototypeOf(ne,Qe.Duplex);function Yn(){const e=this.constructor.call(),{debuglog:t,queueListener:i,...r}=this.options;return e.options=structuredClone(r),e.options.debuglog=t,e.options.queueListener=i,this._isStreamInput()&&this.on("finish",()=>{this._flattenBufferIn(),e.options.input.buffer=this.options.input.buffer,e.emit("finish")}),e}Object.assign(ne.prototype,{clone:Yn});var Kn=ne,Vt={exports:{}},Zn={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Jt={exports:{}},eo=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")},to=eo,io=Array.prototype.concat,ro=Array.prototype.slice,Yt=Jt.exports=function(e){for(var t=[],i=0,r=e.length;i<r;i++){var o=e[i];to(o)?t=io.call(t,ro.call(o)):t.push(o)}return t};Yt.wrap=function(e){return function(){return e(Yt(arguments))}};var no=Jt.exports,be=Zn,we=no,Kt=Object.hasOwnProperty,Zt=Object.create(null);for(var Ve in be)Kt.call(be,Ve)&&(Zt[be[Ve]]=Ve);var C=Vt.exports={to:{},get:{}};C.get=function(e){var t=e.substring(0,3).toLowerCase(),i,r;switch(t){case"hsl":i=C.get.hsl(e),r="hsl";break;case"hwb":i=C.get.hwb(e),r="hwb";break;default:i=C.get.rgb(e),r="rgb";break}return i?{model:r,value:i}:null},C.get.rgb=function(e){if(!e)return null;var t=/^#([a-f0-9]{3,4})$/i,i=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,r=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,o=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,a=/^(\w+)$/,s=[0,0,0,1],u,l,p;if(u=e.match(i)){for(p=u[2],u=u[1],l=0;l<3;l++){var b=l*2;s[l]=parseInt(u.slice(b,b+2),16)}p&&(s[3]=parseInt(p,16)/255)}else if(u=e.match(t)){for(u=u[1],p=u[3],l=0;l<3;l++)s[l]=parseInt(u[l]+u[l],16);p&&(s[3]=parseInt(p+p,16)/255)}else if(u=e.match(r)){for(l=0;l<3;l++)s[l]=parseInt(u[l+1],0);u[4]&&(u[5]?s[3]=parseFloat(u[4])*.01:s[3]=parseFloat(u[4]))}else if(u=e.match(o)){for(l=0;l<3;l++)s[l]=Math.round(parseFloat(u[l+1])*2.55);u[4]&&(u[5]?s[3]=parseFloat(u[4])*.01:s[3]=parseFloat(u[4]))}else return(u=e.match(a))?u[1]==="transparent"?[0,0,0,0]:Kt.call(be,u[1])?(s=be[u[1]],s[3]=1,s):null:null;for(l=0;l<3;l++)s[l]=Y(s[l],0,255);return s[3]=Y(s[3],0,1),s},C.get.hsl=function(e){if(!e)return null;var t=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,i=e.match(t);if(i){var r=parseFloat(i[4]),o=(parseFloat(i[1])%360+360)%360,a=Y(parseFloat(i[2]),0,100),s=Y(parseFloat(i[3]),0,100),u=Y(isNaN(r)?1:r,0,1);return[o,a,s,u]}return null},C.get.hwb=function(e){if(!e)return null;var t=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,i=e.match(t);if(i){var r=parseFloat(i[4]),o=(parseFloat(i[1])%360+360)%360,a=Y(parseFloat(i[2]),0,100),s=Y(parseFloat(i[3]),0,100),u=Y(isNaN(r)?1:r,0,1);return[o,a,s,u]}return null},C.to.hex=function(){var e=we(arguments);return"#"+Le(e[0])+Le(e[1])+Le(e[2])+(e[3]<1?Le(Math.round(e[3]*255)):"")},C.to.rgb=function(){var e=we(arguments);return e.length<4||e[3]===1?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},C.to.rgb.percent=function(){var e=we(arguments),t=Math.round(e[0]/255*100),i=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||e[3]===1?"rgb("+t+"%, "+i+"%, "+r+"%)":"rgba("+t+"%, "+i+"%, "+r+"%, "+e[3]+")"},C.to.hsl=function(){var e=we(arguments);return e.length<4||e[3]===1?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},C.to.hwb=function(){var e=we(arguments),t="";return e.length>=4&&e[3]!==1&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},C.to.keyword=function(e){return Zt[e.slice(0,3)]};function Y(e,t,i){return Math.min(Math.max(t,e),i)}function Le(e){var t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}var oo=Vt.exports,ao={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};const ve=ao,ei={};for(const e of Object.keys(ve))ei[ve[e]]=e;const m={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};var ti=m;for(const e of Object.keys(m)){if(!("channels"in m[e]))throw new Error("missing channels property: "+e);if(!("labels"in m[e]))throw new Error("missing channel labels property: "+e);if(m[e].labels.length!==m[e].channels)throw new Error("channel and label counts mismatch: "+e);const{channels:t,labels:i}=m[e];delete m[e].channels,delete m[e].labels,Object.defineProperty(m[e],"channels",{value:t}),Object.defineProperty(m[e],"labels",{value:i})}m.rgb.hsl=function(e){const t=e[0]/255,i=e[1]/255,r=e[2]/255,o=Math.min(t,i,r),a=Math.max(t,i,r),s=a-o;let u,l;a===o?u=0:t===a?u=(i-r)/s:i===a?u=2+(r-t)/s:r===a&&(u=4+(t-i)/s),u=Math.min(u*60,360),u<0&&(u+=360);const p=(o+a)/2;return a===o?l=0:p<=.5?l=s/(a+o):l=s/(2-a-o),[u,l*100,p*100]},m.rgb.hsv=function(e){let t,i,r,o,a;const s=e[0]/255,u=e[1]/255,l=e[2]/255,p=Math.max(s,u,l),b=p-Math.min(s,u,l),O=function(T){return(p-T)/6/b+1/2};return b===0?(o=0,a=0):(a=b/p,t=O(s),i=O(u),r=O(l),s===p?o=r-i:u===p?o=1/3+t-r:l===p&&(o=2/3+i-t),o<0?o+=1:o>1&&(o-=1)),[o*360,a*100,p*100]},m.rgb.hwb=function(e){const t=e[0],i=e[1];let r=e[2];const o=m.rgb.hsl(e)[0],a=1/255*Math.min(t,Math.min(i,r));return r=1-1/255*Math.max(t,Math.max(i,r)),[o,a*100,r*100]},m.rgb.cmyk=function(e){const t=e[0]/255,i=e[1]/255,r=e[2]/255,o=Math.min(1-t,1-i,1-r),a=(1-t-o)/(1-o)||0,s=(1-i-o)/(1-o)||0,u=(1-r-o)/(1-o)||0;return[a*100,s*100,u*100,o*100]};function so(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2}m.rgb.keyword=function(e){const t=ei[e];if(t)return t;let i=1/0,r;for(const o of Object.keys(ve)){const a=ve[o],s=so(e,a);s<i&&(i=s,r=o)}return r},m.keyword.rgb=function(e){return ve[e]},m.rgb.xyz=function(e){let t=e[0]/255,i=e[1]/255,r=e[2]/255;t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,i=i>.04045?((i+.055)/1.055)**2.4:i/12.92,r=r>.04045?((r+.055)/1.055)**2.4:r/12.92;const o=t*.4124+i*.3576+r*.1805,a=t*.2126+i*.7152+r*.0722,s=t*.0193+i*.1192+r*.9505;return[o*100,a*100,s*100]},m.rgb.lab=function(e){const t=m.rgb.xyz(e);let i=t[0],r=t[1],o=t[2];i/=95.047,r/=100,o/=108.883,i=i>.008856?i**(1/3):7.787*i+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,o=o>.008856?o**(1/3):7.787*o+16/116;const a=116*r-16,s=500*(i-r),u=200*(r-o);return[a,s,u]},m.hsl.rgb=function(e){const t=e[0]/360,i=e[1]/100,r=e[2]/100;let o,a,s;if(i===0)return s=r*255,[s,s,s];r<.5?o=r*(1+i):o=r+i-r*i;const u=2*r-o,l=[0,0,0];for(let p=0;p<3;p++)a=t+1/3*-(p-1),a<0&&a++,a>1&&a--,6*a<1?s=u+(o-u)*6*a:2*a<1?s=o:3*a<2?s=u+(o-u)*(2/3-a)*6:s=u,l[p]=s*255;return l},m.hsl.hsv=function(e){const t=e[0];let i=e[1]/100,r=e[2]/100,o=i;const a=Math.max(r,.01);r*=2,i*=r<=1?r:2-r,o*=a<=1?a:2-a;const s=(r+i)/2,u=r===0?2*o/(a+o):2*i/(r+i);return[t,u*100,s*100]},m.hsv.rgb=function(e){const t=e[0]/60,i=e[1]/100;let r=e[2]/100;const o=Math.floor(t)%6,a=t-Math.floor(t),s=255*r*(1-i),u=255*r*(1-i*a),l=255*r*(1-i*(1-a));switch(r*=255,o){case 0:return[r,l,s];case 1:return[u,r,s];case 2:return[s,r,l];case 3:return[s,u,r];case 4:return[l,s,r];case 5:return[r,s,u]}},m.hsv.hsl=function(e){const t=e[0],i=e[1]/100,r=e[2]/100,o=Math.max(r,.01);let a,s;s=(2-i)*r;const u=(2-i)*o;return a=i*o,a/=u<=1?u:2-u,a=a||0,s/=2,[t,a*100,s*100]},m.hwb.rgb=function(e){const t=e[0]/360;let i=e[1]/100,r=e[2]/100;const o=i+r;let a;o>1&&(i/=o,r/=o);const s=Math.floor(6*t),u=1-r;a=6*t-s,s&1&&(a=1-a);const l=i+a*(u-i);let p,b,O;switch(s){default:case 6:case 0:p=u,b=l,O=i;break;case 1:p=l,b=u,O=i;break;case 2:p=i,b=u,O=l;break;case 3:p=i,b=l,O=u;break;case 4:p=l,b=i,O=u;break;case 5:p=u,b=i,O=l;break}return[p*255,b*255,O*255]},m.cmyk.rgb=function(e){const t=e[0]/100,i=e[1]/100,r=e[2]/100,o=e[3]/100,a=1-Math.min(1,t*(1-o)+o),s=1-Math.min(1,i*(1-o)+o),u=1-Math.min(1,r*(1-o)+o);return[a*255,s*255,u*255]},m.xyz.rgb=function(e){const t=e[0]/100,i=e[1]/100,r=e[2]/100;let o,a,s;return o=t*3.2406+i*-1.5372+r*-.4986,a=t*-.9689+i*1.8758+r*.0415,s=t*.0557+i*-.204+r*1.057,o=o>.0031308?1.055*o**(1/2.4)-.055:o*12.92,a=a>.0031308?1.055*a**(1/2.4)-.055:a*12.92,s=s>.0031308?1.055*s**(1/2.4)-.055:s*12.92,o=Math.min(Math.max(0,o),1),a=Math.min(Math.max(0,a),1),s=Math.min(Math.max(0,s),1),[o*255,a*255,s*255]},m.xyz.lab=function(e){let t=e[0],i=e[1],r=e[2];t/=95.047,i/=100,r/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,i=i>.008856?i**(1/3):7.787*i+16/116,r=r>.008856?r**(1/3):7.787*r+16/116;const o=116*i-16,a=500*(t-i),s=200*(i-r);return[o,a,s]},m.lab.xyz=function(e){const t=e[0],i=e[1],r=e[2];let o,a,s;a=(t+16)/116,o=i/500+a,s=a-r/200;const u=a**3,l=o**3,p=s**3;return a=u>.008856?u:(a-16/116)/7.787,o=l>.008856?l:(o-16/116)/7.787,s=p>.008856?p:(s-16/116)/7.787,o*=95.047,a*=100,s*=108.883,[o,a,s]},m.lab.lch=function(e){const t=e[0],i=e[1],r=e[2];let o;o=Math.atan2(r,i)*360/2/Math.PI,o<0&&(o+=360);const a=Math.sqrt(i*i+r*r);return[t,a,o]},m.lch.lab=function(e){const t=e[0],i=e[1],r=e[2]/360*2*Math.PI,o=i*Math.cos(r),a=i*Math.sin(r);return[t,o,a]},m.rgb.ansi16=function(e,t=null){const[i,r,o]=e;let a=t===null?m.rgb.hsv(e)[2]:t;if(a=Math.round(a/50),a===0)return 30;let s=30+(Math.round(o/255)<<2|Math.round(r/255)<<1|Math.round(i/255));return a===2&&(s+=60),s},m.hsv.ansi16=function(e){return m.rgb.ansi16(m.hsv.rgb(e),e[2])},m.rgb.ansi256=function(e){const t=e[0],i=e[1],r=e[2];return t===i&&i===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(i/255*5)+Math.round(r/255*5)},m.ansi16.rgb=function(e){let t=e%10;if(t===0||t===7)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];const i=(~~(e>50)+1)*.5,r=(t&1)*i*255,o=(t>>1&1)*i*255,a=(t>>2&1)*i*255;return[r,o,a]},m.ansi256.rgb=function(e){if(e>=232){const a=(e-232)*10+8;return[a,a,a]}e-=16;let t;const i=Math.floor(e/36)/5*255,r=Math.floor((t=e%36)/6)/5*255,o=t%6/5*255;return[i,r,o]},m.rgb.hex=function(e){const t=(((Math.round(e[0])&255)<<16)+((Math.round(e[1])&255)<<8)+(Math.round(e[2])&255)).toString(16).toUpperCase();return"000000".substring(t.length)+t},m.hex.rgb=function(e){const t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let i=t[0];t[0].length===3&&(i=i.split("").map(u=>u+u).join(""));const r=parseInt(i,16),o=r>>16&255,a=r>>8&255,s=r&255;return[o,a,s]},m.rgb.hcg=function(e){const t=e[0]/255,i=e[1]/255,r=e[2]/255,o=Math.max(Math.max(t,i),r),a=Math.min(Math.min(t,i),r),s=o-a;let u,l;return s<1?u=a/(1-s):u=0,s<=0?l=0:o===t?l=(i-r)/s%6:o===i?l=2+(r-t)/s:l=4+(t-i)/s,l/=6,l%=1,[l*360,s*100,u*100]},m.hsl.hcg=function(e){const t=e[1]/100,i=e[2]/100,r=i<.5?2*t*i:2*t*(1-i);let o=0;return r<1&&(o=(i-.5*r)/(1-r)),[e[0],r*100,o*100]},m.hsv.hcg=function(e){const t=e[1]/100,i=e[2]/100,r=t*i;let o=0;return r<1&&(o=(i-r)/(1-r)),[e[0],r*100,o*100]},m.hcg.rgb=function(e){const t=e[0]/360,i=e[1]/100,r=e[2]/100;if(i===0)return[r*255,r*255,r*255];const o=[0,0,0],a=t%1*6,s=a%1,u=1-s;let l=0;switch(Math.floor(a)){case 0:o[0]=1,o[1]=s,o[2]=0;break;case 1:o[0]=u,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=s;break;case 3:o[0]=0,o[1]=u,o[2]=1;break;case 4:o[0]=s,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=u}return l=(1-i)*r,[(i*o[0]+l)*255,(i*o[1]+l)*255,(i*o[2]+l)*255]},m.hcg.hsv=function(e){const t=e[1]/100,i=e[2]/100,r=t+i*(1-t);let o=0;return r>0&&(o=t/r),[e[0],o*100,r*100]},m.hcg.hsl=function(e){const t=e[1]/100,i=e[2]/100*(1-t)+.5*t;let r=0;return i>0&&i<.5?r=t/(2*i):i>=.5&&i<1&&(r=t/(2*(1-i))),[e[0],r*100,i*100]},m.hcg.hwb=function(e){const t=e[1]/100,i=e[2]/100,r=t+i*(1-t);return[e[0],(r-t)*100,(1-r)*100]},m.hwb.hcg=function(e){const t=e[1]/100,i=1-e[2]/100,r=i-t;let o=0;return r<1&&(o=(i-r)/(1-r)),[e[0],r*100,o*100]},m.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},m.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},m.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},m.gray.hsl=function(e){return[0,0,e[0]]},m.gray.hsv=m.gray.hsl,m.gray.hwb=function(e){return[0,100,e[0]]},m.gray.cmyk=function(e){return[0,0,0,e[0]]},m.gray.lab=function(e){return[e[0],0,0]},m.gray.hex=function(e){const t=Math.round(e[0]/100*255)&255,i=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(i.length)+i},m.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]};const Se=ti;function lo(){const e={},t=Object.keys(Se);for(let i=t.length,r=0;r<i;r++)e[t[r]]={distance:-1,parent:null};return e}function ho(e){const t=lo(),i=[e];for(t[e].distance=0;i.length;){const r=i.pop(),o=Object.keys(Se[r]);for(let a=o.length,s=0;s<a;s++){const u=o[s],l=t[u];l.distance===-1&&(l.distance=t[r].distance+1,l.parent=r,i.unshift(u))}}return t}function co(e,t){return function(i){return t(e(i))}}function po(e,t){const i=[t[e].parent,e];let r=Se[t[e].parent][e],o=t[e].parent;for(;t[o].parent;)i.unshift(t[o].parent),r=co(Se[t[o].parent][o],r),o=t[o].parent;return r.conversion=i,r}var uo=function(e){const t=ho(e),i={},r=Object.keys(t);for(let o=r.length,a=0;a<o;a++){const s=r[a];t[s].parent!==null&&(i[s]=po(s,t))}return i};const Je=ti,fo=uo,pe={},mo=Object.keys(Je);function go(e){const t=function(...i){const r=i[0];return r==null?r:(r.length>1&&(i=r),e(i))};return"conversion"in e&&(t.conversion=e.conversion),t}function bo(e){const t=function(...i){const r=i[0];if(r==null)return r;r.length>1&&(i=r);const o=e(i);if(typeof o=="object")for(let a=o.length,s=0;s<a;s++)o[s]=Math.round(o[s]);return o};return"conversion"in e&&(t.conversion=e.conversion),t}mo.forEach(e=>{pe[e]={},Object.defineProperty(pe[e],"channels",{value:Je[e].channels}),Object.defineProperty(pe[e],"labels",{value:Je[e].labels});const t=fo(e);Object.keys(t).forEach(i=>{const r=t[i];pe[e][i]=bo(r),pe[e][i].raw=go(r)})});var wo=pe;const ue=oo,B=wo,ii=["keyword","gray","hex"],Ye={};for(const e of Object.keys(B))Ye[[...B[e].labels].sort().join("")]=e;const Me={};function M(e,t){if(!(this instanceof M))return new M(e,t);if(t&&t in ii&&(t=null),t&&!(t in B))throw new Error("Unknown model: "+t);let i,r;if(e==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof M)this.model=e.model,this.color=[...e.color],this.valpha=e.valpha;else if(typeof e=="string"){const o=ue.get(e);if(o===null)throw new Error("Unable to parse color from string: "+e);this.model=o.model,r=B[this.model].channels,this.color=o.value.slice(0,r),this.valpha=typeof o.value[r]=="number"?o.value[r]:1}else if(e.length>0){this.model=t||"rgb",r=B[this.model].channels;const o=Array.prototype.slice.call(e,0,r);this.color=Ke(o,r),this.valpha=typeof e[r]=="number"?e[r]:1}else if(typeof e=="number")this.model="rgb",this.color=[e>>16&255,e>>8&255,e&255],this.valpha=1;else{this.valpha=1;const o=Object.keys(e);"alpha"in e&&(o.splice(o.indexOf("alpha"),1),this.valpha=typeof e.alpha=="number"?e.alpha:0);const a=o.sort().join("");if(!(a in Ye))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=Ye[a];const{labels:s}=B[this.model],u=[];for(i=0;i<s.length;i++)u.push(e[s[i]]);this.color=Ke(u)}if(Me[this.model])for(r=B[this.model].channels,i=0;i<r;i++){const o=Me[this.model][i];o&&(this.color[i]=o(this.color[i]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}M.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(e){let t=this.model in ue.to?this:this.rgb();t=t.round(typeof e=="number"?e:1);const i=t.valpha===1?t.color:[...t.color,this.valpha];return ue.to[t.model](i)},percentString(e){const t=this.rgb().round(typeof e=="number"?e:1),i=t.valpha===1?t.color:[...t.color,this.valpha];return ue.to.rgb.percent(i)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){const e={},{channels:t}=B[this.model],{labels:i}=B[this.model];for(let r=0;r<t;r++)e[i[r]]=this.color[r];return this.valpha!==1&&(e.alpha=this.valpha),e},unitArray(){const e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,this.valpha!==1&&e.push(this.valpha),e},unitObject(){const e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,this.valpha!==1&&(e.alpha=this.valpha),e},round(e){return e=Math.max(e||0,0),new M([...this.color.map(yo(e)),this.valpha],this.model)},alpha(e){return e!==void 0?new M([...this.color,Math.max(0,Math.min(1,e))],this.model):this.valpha},red:$("rgb",0,S(255)),green:$("rgb",1,S(255)),blue:$("rgb",2,S(255)),hue:$(["hsl","hsv","hsl","hwb","hcg"],0,e=>(e%360+360)%360),saturationl:$("hsl",1,S(100)),lightness:$("hsl",2,S(100)),saturationv:$("hsv",1,S(100)),value:$("hsv",2,S(100)),chroma:$("hcg",1,S(100)),gray:$("hcg",2,S(100)),white:$("hwb",1,S(100)),wblack:$("hwb",2,S(100)),cyan:$("cmyk",0,S(100)),magenta:$("cmyk",1,S(100)),yellow:$("cmyk",2,S(100)),black:$("cmyk",3,S(100)),x:$("xyz",0,S(95.047)),y:$("xyz",1,S(100)),z:$("xyz",2,S(108.833)),l:$("lab",0,S(100)),a:$("lab",1),b:$("lab",2),keyword(e){return e!==void 0?new M(e):B[this.model].keyword(this.color)},hex(e){return e!==void 0?new M(e):ue.to.hex(this.rgb().round().color)},hexa(e){if(e!==void 0)return new M(e);const t=this.rgb().round().color;let i=Math.round(this.valpha*255).toString(16).toUpperCase();return i.length===1&&(i="0"+i),ue.to.hex(t)+i},rgbNumber(){const e=this.rgb().color;return(e[0]&255)<<16|(e[1]&255)<<8|e[2]&255},luminosity(){const e=this.rgb().color,t=[];for(const[i,r]of e.entries()){const o=r/255;t[i]=o<=.04045?o/12.92:((o+.055)/1.055)**2.4}return .2126*t[0]+.7152*t[1]+.0722*t[2]},contrast(e){const t=this.luminosity(),i=e.luminosity();return t>i?(t+.05)/(i+.05):(i+.05)/(t+.05)},level(e){const t=this.contrast(e);return t>=7?"AAA":t>=4.5?"AA":""},isDark(){const e=this.rgb().color;return(e[0]*2126+e[1]*7152+e[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){const e=this.rgb();for(let t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten(e){const t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken(e){const t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate(e){const t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate(e){const t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten(e){const t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken(e){const t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale(){const e=this.rgb().color,t=e[0]*.3+e[1]*.59+e[2]*.11;return M.rgb(t,t,t)},fade(e){return this.alpha(this.valpha-this.valpha*e)},opaquer(e){return this.alpha(this.valpha+this.valpha*e)},rotate(e){const t=this.hsl();let i=t.color[0];return i=(i+e)%360,i=i<0?360+i:i,t.color[0]=i,t},mix(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);const i=e.rgb(),r=this.rgb(),o=t===void 0?.5:t,a=2*o-1,s=i.alpha()-r.alpha(),u=((a*s===-1?a:(a+s)/(1+a*s))+1)/2,l=1-u;return M.rgb(u*i.red()+l*r.red(),u*i.green()+l*r.green(),u*i.blue()+l*r.blue(),i.alpha()*o+r.alpha()*(1-o))}};for(const e of Object.keys(B)){if(ii.includes(e))continue;const{channels:t}=B[e];M.prototype[e]=function(...i){return this.model===e?new M(this):i.length>0?new M(i,e):new M([...Eo(B[this.model][e].raw(this.color)),this.valpha],e)},M[e]=function(...i){let r=i[0];return typeof r=="number"&&(r=Ke(i,t)),new M(r,e)}}function vo(e,t){return Number(e.toFixed(t))}function yo(e){return function(t){return vo(t,e)}}function $(e,t,i){e=Array.isArray(e)?e:[e];for(const r of e)(Me[r]||(Me[r]=[]))[t]=i;return e=e[0],function(r){let o;return r!==void 0?(i&&(r=i(r)),o=this[e](),o.color[t]=r,o):(o=this[e]().color[t],i&&(o=i(o)),o)}}function S(e){return function(t){return Math.max(0,Math.min(e,t))}}function Eo(e){return Array.isArray(e)?e:[e]}function Ke(e,t){for(let i=0;i<t;i++)typeof e[i]!="number"&&(e[i]=0);return e}var Ze=M;const xo=Ze,c=H,K=Xe,Po={left:"low",center:"centre",centre:"centre",right:"high"};function ri(e){const{raw:t,density:i,limitInputPixels:r,ignoreIcc:o,unlimited:a,sequentialRead:s,failOn:u,failOnError:l,animated:p,page:b,pages:O,subifd:T}=e;return[t,i,r,o,a,s,u,l,p,b,O,T].some(c.defined)?{raw:t,density:i,limitInputPixels:r,ignoreIcc:o,unlimited:a,sequentialRead:s,failOn:u,failOnError:l,animated:p,page:b,pages:O,subifd:T}:void 0}function Oo(e,t,i){const r={failOn:"warning",limitInputPixels:Math.pow(16383,2),ignoreIcc:!1,unlimited:!1,sequentialRead:!0};if(c.string(e))r.file=e;else if(c.buffer(e)){if(e.length===0)throw Error("Input Buffer is empty");r.buffer=e}else if(c.arrayBuffer(e)){if(e.byteLength===0)throw Error("Input bit Array is empty");r.buffer=Buffer.from(e,0,e.byteLength)}else if(c.typedArray(e)){if(e.length===0)throw Error("Input Bit Array is empty");r.buffer=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}else if(c.plainObject(e)&&!c.defined(t))t=e,ri(t)&&(r.buffer=[]);else if(!c.defined(e)&&!c.defined(t)&&c.object(i)&&i.allowStream)r.buffer=[];else throw new Error(`Unsupported input '${e}' of type ${typeof e}${c.defined(t)?` when also providing options of type ${typeof t}`:""}`);if(c.object(t)){if(c.defined(t.failOnError))if(c.bool(t.failOnError))r.failOn=t.failOnError?"warning":"none";else throw c.invalidParameterError("failOnError","boolean",t.failOnError);if(c.defined(t.failOn))if(c.string(t.failOn)&&c.inArray(t.failOn,["none","truncated","error","warning"]))r.failOn=t.failOn;else throw c.invalidParameterError("failOn","one of: none, truncated, error, warning",t.failOn);if(c.defined(t.density))if(c.inRange(t.density,1,1e5))r.density=t.density;else throw c.invalidParameterError("density","number between 1 and 100000",t.density);if(c.defined(t.ignoreIcc))if(c.bool(t.ignoreIcc))r.ignoreIcc=t.ignoreIcc;else throw c.invalidParameterError("ignoreIcc","boolean",t.ignoreIcc);if(c.defined(t.limitInputPixels))if(c.bool(t.limitInputPixels))r.limitInputPixels=t.limitInputPixels?Math.pow(16383,2):0;else if(c.integer(t.limitInputPixels)&&c.inRange(t.limitInputPixels,0,Number.MAX_SAFE_INTEGER))r.limitInputPixels=t.limitInputPixels;else throw c.invalidParameterError("limitInputPixels","positive integer",t.limitInputPixels);if(c.defined(t.unlimited))if(c.bool(t.unlimited))r.unlimited=t.unlimited;else throw c.invalidParameterError("unlimited","boolean",t.unlimited);if(c.defined(t.sequentialRead))if(c.bool(t.sequentialRead))r.sequentialRead=t.sequentialRead;else throw c.invalidParameterError("sequentialRead","boolean",t.sequentialRead);if(c.defined(t.raw))if(c.object(t.raw)&&c.integer(t.raw.width)&&t.raw.width>0&&c.integer(t.raw.height)&&t.raw.height>0&&c.integer(t.raw.channels)&&c.inRange(t.raw.channels,1,4))switch(r.rawWidth=t.raw.width,r.rawHeight=t.raw.height,r.rawChannels=t.raw.channels,r.rawPremultiplied=!!t.raw.premultiplied,e.constructor){case Uint8Array:case Uint8ClampedArray:r.rawDepth="uchar";break;case Int8Array:r.rawDepth="char";break;case Uint16Array:r.rawDepth="ushort";break;case Int16Array:r.rawDepth="short";break;case Uint32Array:r.rawDepth="uint";break;case Int32Array:r.rawDepth="int";break;case Float32Array:r.rawDepth="float";break;case Float64Array:r.rawDepth="double";break;default:r.rawDepth="uchar";break}else throw new Error("Expected width, height and channels for raw pixel input");if(c.defined(t.animated))if(c.bool(t.animated))r.pages=t.animated?-1:1;else throw c.invalidParameterError("animated","boolean",t.animated);if(c.defined(t.pages))if(c.integer(t.pages)&&c.inRange(t.pages,-1,1e5))r.pages=t.pages;else throw c.invalidParameterError("pages","integer between -1 and 100000",t.pages);if(c.defined(t.page))if(c.integer(t.page)&&c.inRange(t.page,0,1e5))r.page=t.page;else throw c.invalidParameterError("page","integer between 0 and 100000",t.page);if(c.defined(t.level))if(c.integer(t.level)&&c.inRange(t.level,0,256))r.level=t.level;else throw c.invalidParameterError("level","integer between 0 and 256",t.level);if(c.defined(t.subifd))if(c.integer(t.subifd)&&c.inRange(t.subifd,-1,1e5))r.subifd=t.subifd;else throw c.invalidParameterError("subifd","integer between -1 and 100000",t.subifd);if(c.defined(t.create))if(c.object(t.create)&&c.integer(t.create.width)&&t.create.width>0&&c.integer(t.create.height)&&t.create.height>0&&c.integer(t.create.channels)){if(r.createWidth=t.create.width,r.createHeight=t.create.height,r.createChannels=t.create.channels,c.defined(t.create.noise)){if(!c.object(t.create.noise))throw new Error("Expected noise to be an object");if(!c.inArray(t.create.noise.type,["gaussian"]))throw new Error("Only gaussian noise is supported at the moment");if(!c.inRange(t.create.channels,1,4))throw c.invalidParameterError("create.channels","number between 1 and 4",t.create.channels);if(r.createNoiseType=t.create.noise.type,c.number(t.create.noise.mean)&&c.inRange(t.create.noise.mean,0,1e4))r.createNoiseMean=t.create.noise.mean;else throw c.invalidParameterError("create.noise.mean","number between 0 and 10000",t.create.noise.mean);if(c.number(t.create.noise.sigma)&&c.inRange(t.create.noise.sigma,0,1e4))r.createNoiseSigma=t.create.noise.sigma;else throw c.invalidParameterError("create.noise.sigma","number between 0 and 10000",t.create.noise.sigma)}else if(c.defined(t.create.background)){if(!c.inRange(t.create.channels,3,4))throw c.invalidParameterError("create.channels","number between 3 and 4",t.create.channels);const o=xo(t.create.background);r.createBackground=[o.red(),o.green(),o.blue(),Math.round(o.alpha()*255)]}else throw new Error("Expected valid noise or background to create a new input image");delete r.buffer}else throw new Error("Expected valid width, height and channels to create a new input image");if(c.defined(t.text))if(c.object(t.text)&&c.string(t.text.text)){if(r.textValue=t.text.text,c.defined(t.text.height)&&c.defined(t.text.dpi))throw new Error("Expected only one of dpi or height");if(c.defined(t.text.font))if(c.string(t.text.font))r.textFont=t.text.font;else throw c.invalidParameterError("text.font","string",t.text.font);if(c.defined(t.text.fontfile))if(c.string(t.text.fontfile))r.textFontfile=t.text.fontfile;else throw c.invalidParameterError("text.fontfile","string",t.text.fontfile);if(c.defined(t.text.width))if(c.integer(t.text.width)&&t.text.width>0)r.textWidth=t.text.width;else throw c.invalidParameterError("text.width","positive integer",t.text.width);if(c.defined(t.text.height))if(c.integer(t.text.height)&&t.text.height>0)r.textHeight=t.text.height;else throw c.invalidParameterError("text.height","positive integer",t.text.height);if(c.defined(t.text.align))if(c.string(t.text.align)&&c.string(this.constructor.align[t.text.align]))r.textAlign=this.constructor.align[t.text.align];else throw c.invalidParameterError("text.align","valid alignment",t.text.align);if(c.defined(t.text.justify))if(c.bool(t.text.justify))r.textJustify=t.text.justify;else throw c.invalidParameterError("text.justify","boolean",t.text.justify);if(c.defined(t.text.dpi))if(c.integer(t.text.dpi)&&c.inRange(t.text.dpi,1,1e6))r.textDpi=t.text.dpi;else throw c.invalidParameterError("text.dpi","integer between 1 and 1000000",t.text.dpi);if(c.defined(t.text.rgba))if(c.bool(t.text.rgba))r.textRgba=t.text.rgba;else throw c.invalidParameterError("text.rgba","bool",t.text.rgba);if(c.defined(t.text.spacing))if(c.integer(t.text.spacing)&&c.inRange(t.text.spacing,-1e6,1e6))r.textSpacing=t.text.spacing;else throw c.invalidParameterError("text.spacing","integer between -1000000 and 1000000",t.text.spacing);if(c.defined(t.text.wrap))if(c.string(t.text.wrap)&&c.inArray(t.text.wrap,["word","char","word-char","none"]))r.textWrap=t.text.wrap;else throw c.invalidParameterError("text.wrap","one of: word, char, word-char, none",t.text.wrap);delete r.buffer}else throw new Error("Expected a valid string to create an image with text.")}else if(c.defined(t))throw new Error("Invalid input options "+t);return r}function ko(e,t,i){Array.isArray(this.options.input.buffer)?c.buffer(e)?(this.options.input.buffer.length===0&&this.on("finish",()=>{this.streamInFinished=!0}),this.options.input.buffer.push(e),i()):i(new Error("Non-Buffer data on Writable Stream")):i(new Error("Unexpected data on Writable Stream"))}function Ro(){this._isStreamInput()&&(this.options.input.buffer=Buffer.concat(this.options.input.buffer))}function Io(){return Array.isArray(this.options.input.buffer)}function Ao(e){const t=Error();return c.fn(e)?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),K.metadata(this.options,(i,r)=>{i?e(c.nativeError(i,t)):e(null,r)})}):K.metadata(this.options,(i,r)=>{i?e(c.nativeError(i,t)):e(null,r)}),this):this._isStreamInput()?new Promise((i,r)=>{const o=()=>{this._flattenBufferIn(),K.metadata(this.options,(a,s)=>{a?r(c.nativeError(a,t)):i(s)})};this.writableFinished?o():this.once("finish",o)}):new Promise((i,r)=>{K.metadata(this.options,(o,a)=>{o?r(c.nativeError(o,t)):i(a)})})}function jo(e){const t=Error();return c.fn(e)?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),K.stats(this.options,(i,r)=>{i?e(c.nativeError(i,t)):e(null,r)})}):K.stats(this.options,(i,r)=>{i?e(c.nativeError(i,t)):e(null,r)}),this):this._isStreamInput()?new Promise((i,r)=>{this.on("finish",function(){this._flattenBufferIn(),K.stats(this.options,(o,a)=>{o?r(c.nativeError(o,t)):i(a)})})}):new Promise((i,r)=>{K.stats(this.options,(o,a)=>{o?r(c.nativeError(o,t)):i(a)})})}var $o=function(e){Object.assign(e.prototype,{_inputOptionsFromObject:ri,_createInputDescriptor:Oo,_write:ko,_flattenBufferIn:Ro,_isStreamInput:Io,metadata:Ao,stats:jo}),e.align=Po};const g=H,ni={center:0,centre:0,north:1,east:2,south:3,west:4,northeast:5,southeast:6,southwest:7,northwest:8},oi={top:1,right:2,bottom:3,left:4,"right top":5,"right bottom":6,"left bottom":7,"left top":8},ai={background:"background",copy:"copy",repeat:"repeat",mirror:"mirror"},si={entropy:16,attention:17},et={nearest:"nearest",linear:"linear",cubic:"cubic",mitchell:"mitchell",lanczos2:"lanczos2",lanczos3:"lanczos3"},Lo={contain:"contain",cover:"cover",fill:"fill",inside:"inside",outside:"outside"},So={contain:"embed",cover:"crop",fill:"ignore_aspect",inside:"max",outside:"min"};function tt(e){return e.angle%360!==0||e.useExifOrientation===!0||e.rotationAngle!==0}function Ne(e){return e.width!==-1||e.height!==-1}function Mo(e,t,i){if(Ne(this.options)&&this.options.debuglog("ignoring previous resize options"),this.options.widthPost!==-1&&this.options.debuglog("operation order will be: extract, resize, extract"),g.defined(e))if(g.object(e)&&!g.defined(i))i=e;else if(g.integer(e)&&e>0)this.options.width=e;else throw g.invalidParameterError("width","positive integer",e);else this.options.width=-1;if(g.defined(t))if(g.integer(t)&&t>0)this.options.height=t;else throw g.invalidParameterError("height","positive integer",t);else this.options.height=-1;if(g.object(i)){if(g.defined(i.width))if(g.integer(i.width)&&i.width>0)this.options.width=i.width;else throw g.invalidParameterError("width","positive integer",i.width);if(g.defined(i.height))if(g.integer(i.height)&&i.height>0)this.options.height=i.height;else throw g.invalidParameterError("height","positive integer",i.height);if(g.defined(i.fit)){const r=So[i.fit];if(g.string(r))this.options.canvas=r;else throw g.invalidParameterError("fit","valid fit",i.fit)}if(g.defined(i.position)){const r=g.integer(i.position)?i.position:si[i.position]||oi[i.position]||ni[i.position];if(g.integer(r)&&(g.inRange(r,0,8)||g.inRange(r,16,17)))this.options.position=r;else throw g.invalidParameterError("position","valid position/gravity/strategy",i.position)}if(this._setBackgroundColourOption("resizeBackground",i.background),g.defined(i.kernel))if(g.string(et[i.kernel]))this.options.kernel=et[i.kernel];else throw g.invalidParameterError("kernel","valid kernel name",i.kernel);g.defined(i.withoutEnlargement)&&this._setBooleanOption("withoutEnlargement",i.withoutEnlargement),g.defined(i.withoutReduction)&&this._setBooleanOption("withoutReduction",i.withoutReduction),g.defined(i.fastShrinkOnLoad)&&this._setBooleanOption("fastShrinkOnLoad",i.fastShrinkOnLoad)}return tt(this.options)&&Ne(this.options)&&(this.options.rotateBeforePreExtract=!0),this}function No(e){if(g.integer(e)&&e>0)this.options.extendTop=e,this.options.extendBottom=e,this.options.extendLeft=e,this.options.extendRight=e;else if(g.object(e)){if(g.defined(e.top))if(g.integer(e.top)&&e.top>=0)this.options.extendTop=e.top;else throw g.invalidParameterError("top","positive integer",e.top);if(g.defined(e.bottom))if(g.integer(e.bottom)&&e.bottom>=0)this.options.extendBottom=e.bottom;else throw g.invalidParameterError("bottom","positive integer",e.bottom);if(g.defined(e.left))if(g.integer(e.left)&&e.left>=0)this.options.extendLeft=e.left;else throw g.invalidParameterError("left","positive integer",e.left);if(g.defined(e.right))if(g.integer(e.right)&&e.right>=0)this.options.extendRight=e.right;else throw g.invalidParameterError("right","positive integer",e.right);if(this._setBackgroundColourOption("extendBackground",e.background),g.defined(e.extendWith))if(g.string(ai[e.extendWith]))this.options.extendWith=ai[e.extendWith];else throw g.invalidParameterError("extendWith","one of: background, copy, repeat, mirror",e.extendWith)}else throw g.invalidParameterError("extend","integer or object",e);return this}function To(e){const t=Ne(this.options)||this.options.widthPre!==-1?"Post":"Pre";return this.options[`width${t}`]!==-1&&this.options.debuglog("ignoring previous extract options"),["left","top","width","height"].forEach(function(i){const r=e[i];if(g.integer(r)&&r>=0)this.options[i+(i==="left"||i==="top"?"Offset":"")+t]=r;else throw g.invalidParameterError(i,"integer",r)},this),tt(this.options)&&!Ne(this.options)&&(this.options.widthPre===-1||this.options.widthPost===-1)&&(this.options.rotateBeforePreExtract=!0),this}function Co(e){if(this.options.trimThreshold=10,g.defined(e))if(g.object(e)){if(g.defined(e.background)&&this._setBackgroundColourOption("trimBackground",e.background),g.defined(e.threshold))if(g.number(e.threshold)&&e.threshold>=0)this.options.trimThreshold=e.threshold;else throw g.invalidParameterError("threshold","positive number",e.threshold);g.defined(e.lineArt)&&this._setBooleanOption("trimLineArt",e.lineArt)}else throw g.invalidParameterError("trim","object",e);return tt(this.options)&&(this.options.rotateBeforePreExtract=!0),this}var Bo=function(e){Object.assign(e.prototype,{resize:Mo,extend:No,extract:To,trim:Co}),e.gravity=ni,e.strategy=si,e.kernel=et,e.fit=Lo,e.position=oi};const I=H,it={clear:"clear",source:"source",over:"over",in:"in",out:"out",atop:"atop",dest:"dest","dest-over":"dest-over","dest-in":"dest-in","dest-out":"dest-out","dest-atop":"dest-atop",xor:"xor",add:"add",saturate:"saturate",multiply:"multiply",screen:"screen",overlay:"overlay",darken:"darken",lighten:"lighten","colour-dodge":"colour-dodge","color-dodge":"colour-dodge","colour-burn":"colour-burn","color-burn":"colour-burn","hard-light":"hard-light","soft-light":"soft-light",difference:"difference",exclusion:"exclusion"};function _o(e){if(!Array.isArray(e))throw I.invalidParameterError("images to composite","array",e);return this.options.composite=e.map(t=>{if(!I.object(t))throw I.invalidParameterError("image to composite","object",t);const i=this._inputOptionsFromObject(t),r={input:this._createInputDescriptor(t.input,i,{allowStream:!1}),blend:"over",tile:!1,left:0,top:0,hasOffset:!1,gravity:0,premultiplied:!1};if(I.defined(t.blend))if(I.string(it[t.blend]))r.blend=it[t.blend];else throw I.invalidParameterError("blend","valid blend name",t.blend);if(I.defined(t.tile))if(I.bool(t.tile))r.tile=t.tile;else throw I.invalidParameterError("tile","boolean",t.tile);if(I.defined(t.left))if(I.integer(t.left))r.left=t.left;else throw I.invalidParameterError("left","integer",t.left);if(I.defined(t.top))if(I.integer(t.top))r.top=t.top;else throw I.invalidParameterError("top","integer",t.top);if(I.defined(t.top)!==I.defined(t.left))throw new Error("Expected both left and top to be set");if(r.hasOffset=I.integer(t.top)&&I.integer(t.left),I.defined(t.gravity))if(I.integer(t.gravity)&&I.inRange(t.gravity,0,8))r.gravity=t.gravity;else if(I.string(t.gravity)&&I.integer(this.constructor.gravity[t.gravity]))r.gravity=this.constructor.gravity[t.gravity];else throw I.invalidParameterError("gravity","valid gravity",t.gravity);if(I.defined(t.premultiplied))if(I.bool(t.premultiplied))r.premultiplied=t.premultiplied;else throw I.invalidParameterError("premultiplied","boolean",t.premultiplied);return r}),this}var Fo=function(e){e.prototype.composite=_o,e.blend=it};const Do=Ze,h=H,li={integer:"integer",float:"float",approximate:"approximate"};function zo(e,t){if((this.options.useExifOrientation||this.options.angle||this.options.rotationAngle)&&this.options.debuglog("ignoring previous rotate options"),!h.defined(e))this.options.useExifOrientation=!0;else if(h.integer(e)&&!(e%90))this.options.angle=e;else if(h.number(e)){if(this.options.rotationAngle=e,h.object(t)&&t.background){const i=Do(t.background);this.options.rotationBackground=[i.red(),i.green(),i.blue(),Math.round(i.alpha()*255)]}}else throw h.invalidParameterError("angle","numeric",e);return this}function qo(e){return this.options.flip=h.bool(e)?e:!0,this}function Go(e){return this.options.flop=h.bool(e)?e:!0,this}function Uo(e,t){const i=[].concat(...e);if(i.length===4&&i.every(h.number))this.options.affineMatrix=i;else throw h.invalidParameterError("matrix","1x4 or 2x2 array",e);if(h.defined(t))if(h.object(t)){if(this._setBackgroundColourOption("affineBackground",t.background),h.defined(t.idx))if(h.number(t.idx))this.options.affineIdx=t.idx;else throw h.invalidParameterError("options.idx","number",t.idx);if(h.defined(t.idy))if(h.number(t.idy))this.options.affineIdy=t.idy;else throw h.invalidParameterError("options.idy","number",t.idy);if(h.defined(t.odx))if(h.number(t.odx))this.options.affineOdx=t.odx;else throw h.invalidParameterError("options.odx","number",t.odx);if(h.defined(t.ody))if(h.number(t.ody))this.options.affineOdy=t.ody;else throw h.invalidParameterError("options.ody","number",t.ody);if(h.defined(t.interpolator))if(h.inArray(t.interpolator,Object.values(this.constructor.interpolators)))this.options.affineInterpolator=t.interpolator;else throw h.invalidParameterError("options.interpolator","valid interpolator name",t.interpolator)}else throw h.invalidParameterError("options","object",t);return this}function Wo(e,t,i){if(!h.defined(e))this.options.sharpenSigma=-1;else if(h.bool(e))this.options.sharpenSigma=e?-1:0;else if(h.number(e)&&h.inRange(e,.01,1e4)){if(this.options.sharpenSigma=e,h.defined(t))if(h.number(t)&&h.inRange(t,0,1e4))this.options.sharpenM1=t;else throw h.invalidParameterError("flat","number between 0 and 10000",t);if(h.defined(i))if(h.number(i)&&h.inRange(i,0,1e4))this.options.sharpenM2=i;else throw h.invalidParameterError("jagged","number between 0 and 10000",i)}else if(h.plainObject(e)){if(h.number(e.sigma)&&h.inRange(e.sigma,1e-6,10))this.options.sharpenSigma=e.sigma;else throw h.invalidParameterError("options.sigma","number between 0.000001 and 10",e.sigma);if(h.defined(e.m1))if(h.number(e.m1)&&h.inRange(e.m1,0,1e6))this.options.sharpenM1=e.m1;else throw h.invalidParameterError("options.m1","number between 0 and 1000000",e.m1);if(h.defined(e.m2))if(h.number(e.m2)&&h.inRange(e.m2,0,1e6))this.options.sharpenM2=e.m2;else throw h.invalidParameterError("options.m2","number between 0 and 1000000",e.m2);if(h.defined(e.x1))if(h.number(e.x1)&&h.inRange(e.x1,0,1e6))this.options.sharpenX1=e.x1;else throw h.invalidParameterError("options.x1","number between 0 and 1000000",e.x1);if(h.defined(e.y2))if(h.number(e.y2)&&h.inRange(e.y2,0,1e6))this.options.sharpenY2=e.y2;else throw h.invalidParameterError("options.y2","number between 0 and 1000000",e.y2);if(h.defined(e.y3))if(h.number(e.y3)&&h.inRange(e.y3,0,1e6))this.options.sharpenY3=e.y3;else throw h.invalidParameterError("options.y3","number between 0 and 1000000",e.y3)}else throw h.invalidParameterError("sigma","number between 0.01 and 10000",e);return this}function Ho(e){if(!h.defined(e))this.options.medianSize=3;else if(h.integer(e)&&h.inRange(e,1,1e3))this.options.medianSize=e;else throw h.invalidParameterError("size","integer between 1 and 1000",e);return this}function Xo(e){let t;if(h.number(e))t=e;else if(h.plainObject(e)){if(!h.number(e.sigma))throw h.invalidParameterError("options.sigma","number between 0.3 and 1000",t);if(t=e.sigma,"precision"in e)if(h.string(li[e.precision]))this.options.precision=li[e.precision];else throw h.invalidParameterError("precision","one of: integer, float, approximate",e.precision);if("minAmplitude"in e)if(h.number(e.minAmplitude)&&h.inRange(e.minAmplitude,.001,1))this.options.minAmpl=e.minAmplitude;else throw h.invalidParameterError("minAmplitude","number between 0.001 and 1",e.minAmplitude)}if(!h.defined(e))this.options.blurSigma=-1;else if(h.bool(e))this.options.blurSigma=e?-1:0;else if(h.number(t)&&h.inRange(t,.3,1e3))this.options.blurSigma=t;else throw h.invalidParameterError("sigma","number between 0.3 and 1000",t);return this}function Qo(e){return this.options.flatten=h.bool(e)?e:!0,h.object(e)&&this._setBackgroundColourOption("flattenBackground",e.background),this}function Vo(){return this.options.unflatten=!0,this}function Jo(e,t){if(!h.defined(e))this.options.gamma=2.2;else if(h.number(e)&&h.inRange(e,1,3))this.options.gamma=e;else throw h.invalidParameterError("gamma","number between 1.0 and 3.0",e);if(!h.defined(t))this.options.gammaOut=this.options.gamma;else if(h.number(t)&&h.inRange(t,1,3))this.options.gammaOut=t;else throw h.invalidParameterError("gammaOut","number between 1.0 and 3.0",t);return this}function Yo(e){if(this.options.negate=h.bool(e)?e:!0,h.plainObject(e)&&"alpha"in e)if(h.bool(e.alpha))this.options.negateAlpha=e.alpha;else throw h.invalidParameterError("alpha","should be boolean value",e.alpha);return this}function Ko(e){if(h.plainObject(e)){if(h.defined(e.lower))if(h.number(e.lower)&&h.inRange(e.lower,0,99))this.options.normaliseLower=e.lower;else throw h.invalidParameterError("lower","number between 0 and 99",e.lower);if(h.defined(e.upper))if(h.number(e.upper)&&h.inRange(e.upper,1,100))this.options.normaliseUpper=e.upper;else throw h.invalidParameterError("upper","number between 1 and 100",e.upper)}if(this.options.normaliseLower>=this.options.normaliseUpper)throw h.invalidParameterError("range","lower to be less than upper",`${this.options.normaliseLower} >= ${this.options.normaliseUpper}`);return this.options.normalise=!0,this}function Zo(e){return this.normalise(e)}function ea(e){if(h.plainObject(e)){if(h.integer(e.width)&&e.width>0)this.options.claheWidth=e.width;else throw h.invalidParameterError("width","integer greater than zero",e.width);if(h.integer(e.height)&&e.height>0)this.options.claheHeight=e.height;else throw h.invalidParameterError("height","integer greater than zero",e.height);if(h.defined(e.maxSlope))if(h.integer(e.maxSlope)&&h.inRange(e.maxSlope,0,100))this.options.claheMaxSlope=e.maxSlope;else throw h.invalidParameterError("maxSlope","integer between 0 and 100",e.maxSlope)}else throw h.invalidParameterError("options","plain object",e);return this}function ta(e){if(!h.object(e)||!Array.isArray(e.kernel)||!h.integer(e.width)||!h.integer(e.height)||!h.inRange(e.width,3,1001)||!h.inRange(e.height,3,1001)||e.height*e.width!==e.kernel.length)throw new Error("Invalid convolution kernel");return h.integer(e.scale)||(e.scale=e.kernel.reduce(function(t,i){return t+i},0)),e.scale<1&&(e.scale=1),h.integer(e.offset)||(e.offset=0),this.options.convKernel=e,this}function ia(e,t){if(!h.defined(e))this.options.threshold=128;else if(h.bool(e))this.options.threshold=e?128:0;else if(h.integer(e)&&h.inRange(e,0,255))this.options.threshold=e;else throw h.invalidParameterError("threshold","integer between 0 and 255",e);return!h.object(t)||t.greyscale===!0||t.grayscale===!0?this.options.thresholdGrayscale=!0:this.options.thresholdGrayscale=!1,this}function ra(e,t,i){if(this.options.boolean=this._createInputDescriptor(e,i),h.string(t)&&h.inArray(t,["and","or","eor"]))this.options.booleanOp=t;else throw h.invalidParameterError("operator","one of: and, or, eor",t);return this}function na(e,t){if(!h.defined(e)&&h.number(t)?e=1:h.number(e)&&!h.defined(t)&&(t=0),!h.defined(e))this.options.linearA=[];else if(h.number(e))this.options.linearA=[e];else if(Array.isArray(e)&&e.length&&e.every(h.number))this.options.linearA=e;else throw h.invalidParameterError("a","number or array of numbers",e);if(!h.defined(t))this.options.linearB=[];else if(h.number(t))this.options.linearB=[t];else if(Array.isArray(t)&&t.length&&t.every(h.number))this.options.linearB=t;else throw h.invalidParameterError("b","number or array of numbers",t);if(this.options.linearA.length!==this.options.linearB.length)throw new Error("Expected a and b to be arrays of the same length");return this}function oa(e){if(!Array.isArray(e))throw h.invalidParameterError("inputMatrix","array",e);if(e.length!==3&&e.length!==4)throw h.invalidParameterError("inputMatrix","3x3 or 4x4 array",e.length);const t=e.flat().map(Number);if(t.length!==9&&t.length!==16)throw h.invalidParameterError("inputMatrix","cardinality of 9 or 16",t.length);return this.options.recombMatrix=t,this}function aa(e){if(!h.plainObject(e))throw h.invalidParameterError("options","plain object",e);if("brightness"in e)if(h.number(e.brightness)&&e.brightness>=0)this.options.brightness=e.brightness;else throw h.invalidParameterError("brightness","number above zero",e.brightness);if("saturation"in e)if(h.number(e.saturation)&&e.saturation>=0)this.options.saturation=e.saturation;else throw h.invalidParameterError("saturation","number above zero",e.saturation);if("hue"in e)if(h.integer(e.hue))this.options.hue=e.hue%360;else throw h.invalidParameterError("hue","number",e.hue);if("lightness"in e)if(h.number(e.lightness))this.options.lightness=e.lightness;else throw h.invalidParameterError("lightness","number",e.lightness);return this}var sa=function(e){Object.assign(e.prototype,{rotate:zo,flip:qo,flop:Go,affine:Uo,sharpen:Wo,median:Ho,blur:Xo,flatten:Qo,unflatten:Vo,gamma:Jo,negate:Yo,normalise:Ko,normalize:Zo,clahe:ea,convolve:ta,threshold:ia,boolean:ra,linear:na,recomb:oa,modulate:aa})};const la=Ze,X=H,hi={multiband:"multiband","b-w":"b-w",bw:"b-w",cmyk:"cmyk",srgb:"srgb"};function ha(e){return this._setBackgroundColourOption("tint",e),this}function ca(e){return this.options.greyscale=X.bool(e)?e:!0,this}function pa(e){return this.greyscale(e)}function ua(e){if(!X.string(e))throw X.invalidParameterError("colourspace","string",e);return this.options.colourspacePipeline=e,this}function da(e){return this.pipelineColourspace(e)}function fa(e){if(!X.string(e))throw X.invalidParameterError("colourspace","string",e);return this.options.colourspace=e,this}function ma(e){return this.toColourspace(e)}function ga(e,t){if(X.defined(t))if(X.object(t)||X.string(t)){const i=la(t);this.options[e]=[i.red(),i.green(),i.blue(),Math.round(i.alpha()*255)]}else throw X.invalidParameterError("background","object or string",t)}var ba=function(e){Object.assign(e.prototype,{tint:ha,greyscale:ca,grayscale:pa,pipelineColourspace:ua,pipelineColorspace:da,toColourspace:fa,toColorspace:ma,_setBackgroundColourOption:ga}),e.colourspace=hi,e.colorspace=hi};const q=H,wa={and:"and",or:"or",eor:"eor"};function va(){return this.options.removeAlpha=!0,this}function ya(e){if(q.defined(e))if(q.number(e)&&q.inRange(e,0,1))this.options.ensureAlpha=e;else throw q.invalidParameterError("alpha","number between 0 and 1",e);else this.options.ensureAlpha=1;return this}function Ea(e){const t={red:0,green:1,blue:2,alpha:3};if(Object.keys(t).includes(e)&&(e=t[e]),q.integer(e)&&q.inRange(e,0,4))this.options.extractChannel=e;else throw q.invalidParameterError("channel","integer or one of: red, green, blue, alpha",e);return this}function xa(e,t){return Array.isArray(e)?e.forEach(function(i){this.options.joinChannelIn.push(this._createInputDescriptor(i,t))},this):this.options.joinChannelIn.push(this._createInputDescriptor(e,t)),this}function Pa(e){if(q.string(e)&&q.inArray(e,["and","or","eor"]))this.options.bandBoolOp=e;else throw q.invalidParameterError("boolOp","one of: and, or, eor",e);return this}var Oa=function(e){Object.assign(e.prototype,{removeAlpha:va,ensureAlpha:ya,extractChannel:Ea,joinChannel:xa,bandbool:Pa}),e.bool=wa};const rt=W,n=H,de=Xe,ci=new Map([["heic","heif"],["heif","heif"],["avif","avif"],["jpeg","jpeg"],["jpg","jpeg"],["jpe","jpeg"],["tile","tile"],["dz","tile"],["png","png"],["raw","raw"],["tiff","tiff"],["tif","tiff"],["webp","webp"],["gif","gif"],["jp2","jp2"],["jpx","jp2"],["j2k","jp2"],["j2c","jp2"],["jxl","jxl"]]),ka=/\.(jp[2x]|j2[kc])$/i,pi=()=>new Error("JP2 output requires libvips with support for OpenJPEG"),ui=e=>1<<31-Math.clz32(Math.ceil(Math.log2(e)));function Ra(e,t){let i;if(n.string(e)?n.string(this.options.input.file)&&rt.resolve(this.options.input.file)===rt.resolve(e)?i=new Error("Cannot use same file for input and output"):ka.test(rt.extname(e))&&!this.constructor.format.jp2k.output.file&&(i=pi()):i=new Error("Missing output file path"),i)if(n.fn(t))t(i);else return Promise.reject(i);else{this.options.fileOut=e;const r=Error();return this._pipeline(t,r)}return this}function Ia(e,t){n.object(e)?this._setBooleanOption("resolveWithObject",e.resolveWithObject):this.options.resolveWithObject&&(this.options.resolveWithObject=!1),this.options.fileOut="";const i=Error();return this._pipeline(n.fn(e)?e:t,i)}function Aa(){return this.options.keepMetadata|=1,this}function ja(e){if(n.object(e))for(const[t,i]of Object.entries(e))if(n.object(i))for(const[r,o]of Object.entries(i))if(n.string(o))this.options.withExif[`exif-${t.toLowerCase()}-${r}`]=o;else throw n.invalidParameterError(`${t}.${r}`,"string",o);else throw n.invalidParameterError(t,"object",i);else throw n.invalidParameterError("exif","object",e);return this.options.withExifMerge=!1,this.keepExif()}function $a(e){return this.withExif(e),this.options.withExifMerge=!0,this}function La(){return this.options.keepMetadata|=8,this}function Sa(e,t){if(n.string(e))this.options.withIccProfile=e;else throw n.invalidParameterError("icc","string",e);if(this.keepIccProfile(),n.object(t)&&n.defined(t.attach))if(n.bool(t.attach))t.attach||(this.options.keepMetadata&=-9);else throw n.invalidParameterError("attach","boolean",t.attach);return this}function Ma(){return this.options.keepMetadata=31,this}function Na(e){if(this.keepMetadata(),this.withIccProfile("srgb"),n.object(e)){if(n.defined(e.orientation))if(n.integer(e.orientation)&&n.inRange(e.orientation,1,8))this.options.withMetadataOrientation=e.orientation;else throw n.invalidParameterError("orientation","integer between 1 and 8",e.orientation);if(n.defined(e.density))if(n.number(e.density)&&e.density>0)this.options.withMetadataDensity=e.density;else throw n.invalidParameterError("density","positive number",e.density);n.defined(e.icc)&&this.withIccProfile(e.icc),n.defined(e.exif)&&this.withExifMerge(e.exif)}return this}function Ta(e,t){const i=ci.get((n.object(e)&&n.string(e.id)?e.id:e).toLowerCase());if(!i)throw n.invalidParameterError("format",`one of: ${[...ci.keys()].join(", ")}`,e);return this[i](t)}function Ca(e){if(n.object(e)){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.jpegQuality=e.quality;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);if(n.defined(e.progressive)&&this._setBooleanOption("jpegProgressive",e.progressive),n.defined(e.chromaSubsampling))if(n.string(e.chromaSubsampling)&&n.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))this.options.jpegChromaSubsampling=e.chromaSubsampling;else throw n.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling);const t=n.bool(e.optimizeCoding)?e.optimizeCoding:e.optimiseCoding;if(n.defined(t)&&this._setBooleanOption("jpegOptimiseCoding",t),n.defined(e.mozjpeg))if(n.bool(e.mozjpeg))e.mozjpeg&&(this.options.jpegTrellisQuantisation=!0,this.options.jpegOvershootDeringing=!0,this.options.jpegOptimiseScans=!0,this.options.jpegProgressive=!0,this.options.jpegQuantisationTable=3);else throw n.invalidParameterError("mozjpeg","boolean",e.mozjpeg);const i=n.bool(e.trellisQuantization)?e.trellisQuantization:e.trellisQuantisation;n.defined(i)&&this._setBooleanOption("jpegTrellisQuantisation",i),n.defined(e.overshootDeringing)&&this._setBooleanOption("jpegOvershootDeringing",e.overshootDeringing);const r=n.bool(e.optimizeScans)?e.optimizeScans:e.optimiseScans;n.defined(r)&&(this._setBooleanOption("jpegOptimiseScans",r),r&&(this.options.jpegProgressive=!0));const o=n.number(e.quantizationTable)?e.quantizationTable:e.quantisationTable;if(n.defined(o))if(n.integer(o)&&n.inRange(o,0,8))this.options.jpegQuantisationTable=o;else throw n.invalidParameterError("quantisationTable","integer between 0 and 8",o)}return this._updateFormatOut("jpeg",e)}function Ba(e){if(n.object(e)){if(n.defined(e.progressive)&&this._setBooleanOption("pngProgressive",e.progressive),n.defined(e.compressionLevel))if(n.integer(e.compressionLevel)&&n.inRange(e.compressionLevel,0,9))this.options.pngCompressionLevel=e.compressionLevel;else throw n.invalidParameterError("compressionLevel","integer between 0 and 9",e.compressionLevel);n.defined(e.adaptiveFiltering)&&this._setBooleanOption("pngAdaptiveFiltering",e.adaptiveFiltering);const t=e.colours||e.colors;if(n.defined(t))if(n.integer(t)&&n.inRange(t,2,256))this.options.pngBitdepth=ui(t);else throw n.invalidParameterError("colours","integer between 2 and 256",t);if(n.defined(e.palette)?this._setBooleanOption("pngPalette",e.palette):[e.quality,e.effort,e.colours,e.colors,e.dither].some(n.defined)&&this._setBooleanOption("pngPalette",!0),this.options.pngPalette){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,0,100))this.options.pngQuality=e.quality;else throw n.invalidParameterError("quality","integer between 0 and 100",e.quality);if(n.defined(e.effort))if(n.integer(e.effort)&&n.inRange(e.effort,1,10))this.options.pngEffort=e.effort;else throw n.invalidParameterError("effort","integer between 1 and 10",e.effort);if(n.defined(e.dither))if(n.number(e.dither)&&n.inRange(e.dither,0,1))this.options.pngDither=e.dither;else throw n.invalidParameterError("dither","number between 0.0 and 1.0",e.dither)}}return this._updateFormatOut("png",e)}function _a(e){if(n.object(e)){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.webpQuality=e.quality;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);if(n.defined(e.alphaQuality))if(n.integer(e.alphaQuality)&&n.inRange(e.alphaQuality,0,100))this.options.webpAlphaQuality=e.alphaQuality;else throw n.invalidParameterError("alphaQuality","integer between 0 and 100",e.alphaQuality);if(n.defined(e.lossless)&&this._setBooleanOption("webpLossless",e.lossless),n.defined(e.nearLossless)&&this._setBooleanOption("webpNearLossless",e.nearLossless),n.defined(e.smartSubsample)&&this._setBooleanOption("webpSmartSubsample",e.smartSubsample),n.defined(e.preset))if(n.string(e.preset)&&n.inArray(e.preset,["default","photo","picture","drawing","icon","text"]))this.options.webpPreset=e.preset;else throw n.invalidParameterError("preset","one of: default, photo, picture, drawing, icon, text",e.preset);if(n.defined(e.effort))if(n.integer(e.effort)&&n.inRange(e.effort,0,6))this.options.webpEffort=e.effort;else throw n.invalidParameterError("effort","integer between 0 and 6",e.effort);n.defined(e.minSize)&&this._setBooleanOption("webpMinSize",e.minSize),n.defined(e.mixed)&&this._setBooleanOption("webpMixed",e.mixed)}return di(e,this.options),this._updateFormatOut("webp",e)}function Fa(e){if(n.object(e)){n.defined(e.reuse)&&this._setBooleanOption("gifReuse",e.reuse),n.defined(e.progressive)&&this._setBooleanOption("gifProgressive",e.progressive);const t=e.colours||e.colors;if(n.defined(t))if(n.integer(t)&&n.inRange(t,2,256))this.options.gifBitdepth=ui(t);else throw n.invalidParameterError("colours","integer between 2 and 256",t);if(n.defined(e.effort))if(n.number(e.effort)&&n.inRange(e.effort,1,10))this.options.gifEffort=e.effort;else throw n.invalidParameterError("effort","integer between 1 and 10",e.effort);if(n.defined(e.dither))if(n.number(e.dither)&&n.inRange(e.dither,0,1))this.options.gifDither=e.dither;else throw n.invalidParameterError("dither","number between 0.0 and 1.0",e.dither);if(n.defined(e.interFrameMaxError))if(n.number(e.interFrameMaxError)&&n.inRange(e.interFrameMaxError,0,32))this.options.gifInterFrameMaxError=e.interFrameMaxError;else throw n.invalidParameterError("interFrameMaxError","number between 0.0 and 32.0",e.interFrameMaxError);if(n.defined(e.interPaletteMaxError))if(n.number(e.interPaletteMaxError)&&n.inRange(e.interPaletteMaxError,0,256))this.options.gifInterPaletteMaxError=e.interPaletteMaxError;else throw n.invalidParameterError("interPaletteMaxError","number between 0.0 and 256.0",e.interPaletteMaxError)}return di(e,this.options),this._updateFormatOut("gif",e)}function Da(e){if(!this.constructor.format.jp2k.output.buffer)throw pi();if(n.object(e)){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.jp2Quality=e.quality;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);if(n.defined(e.lossless))if(n.bool(e.lossless))this.options.jp2Lossless=e.lossless;else throw n.invalidParameterError("lossless","boolean",e.lossless);if(n.defined(e.tileWidth))if(n.integer(e.tileWidth)&&n.inRange(e.tileWidth,1,32768))this.options.jp2TileWidth=e.tileWidth;else throw n.invalidParameterError("tileWidth","integer between 1 and 32768",e.tileWidth);if(n.defined(e.tileHeight))if(n.integer(e.tileHeight)&&n.inRange(e.tileHeight,1,32768))this.options.jp2TileHeight=e.tileHeight;else throw n.invalidParameterError("tileHeight","integer between 1 and 32768",e.tileHeight);if(n.defined(e.chromaSubsampling))if(n.string(e.chromaSubsampling)&&n.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))this.options.jp2ChromaSubsampling=e.chromaSubsampling;else throw n.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling)}return this._updateFormatOut("jp2",e)}function di(e,t){if(n.object(e)&&n.defined(e.loop))if(n.integer(e.loop)&&n.inRange(e.loop,0,65535))t.loop=e.loop;else throw n.invalidParameterError("loop","integer between 0 and 65535",e.loop);if(n.object(e)&&n.defined(e.delay))if(n.integer(e.delay)&&n.inRange(e.delay,0,65535))t.delay=[e.delay];else if(Array.isArray(e.delay)&&e.delay.every(n.integer)&&e.delay.every(i=>n.inRange(i,0,65535)))t.delay=e.delay;else throw n.invalidParameterError("delay","integer or an array of integers between 0 and 65535",e.delay)}function za(e){if(n.object(e)){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.tiffQuality=e.quality;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);if(n.defined(e.bitdepth))if(n.integer(e.bitdepth)&&n.inArray(e.bitdepth,[1,2,4,8]))this.options.tiffBitdepth=e.bitdepth;else throw n.invalidParameterError("bitdepth","1, 2, 4 or 8",e.bitdepth);if(n.defined(e.tile)&&this._setBooleanOption("tiffTile",e.tile),n.defined(e.tileWidth))if(n.integer(e.tileWidth)&&e.tileWidth>0)this.options.tiffTileWidth=e.tileWidth;else throw n.invalidParameterError("tileWidth","integer greater than zero",e.tileWidth);if(n.defined(e.tileHeight))if(n.integer(e.tileHeight)&&e.tileHeight>0)this.options.tiffTileHeight=e.tileHeight;else throw n.invalidParameterError("tileHeight","integer greater than zero",e.tileHeight);if(n.defined(e.miniswhite)&&this._setBooleanOption("tiffMiniswhite",e.miniswhite),n.defined(e.pyramid)&&this._setBooleanOption("tiffPyramid",e.pyramid),n.defined(e.xres))if(n.number(e.xres)&&e.xres>0)this.options.tiffXres=e.xres;else throw n.invalidParameterError("xres","number greater than zero",e.xres);if(n.defined(e.yres))if(n.number(e.yres)&&e.yres>0)this.options.tiffYres=e.yres;else throw n.invalidParameterError("yres","number greater than zero",e.yres);if(n.defined(e.compression))if(n.string(e.compression)&&n.inArray(e.compression,["none","jpeg","deflate","packbits","ccittfax4","lzw","webp","zstd","jp2k"]))this.options.tiffCompression=e.compression;else throw n.invalidParameterError("compression","one of: none, jpeg, deflate, packbits, ccittfax4, lzw, webp, zstd, jp2k",e.compression);if(n.defined(e.predictor))if(n.string(e.predictor)&&n.inArray(e.predictor,["none","horizontal","float"]))this.options.tiffPredictor=e.predictor;else throw n.invalidParameterError("predictor","one of: none, horizontal, float",e.predictor);if(n.defined(e.resolutionUnit))if(n.string(e.resolutionUnit)&&n.inArray(e.resolutionUnit,["inch","cm"]))this.options.tiffResolutionUnit=e.resolutionUnit;else throw n.invalidParameterError("resolutionUnit","one of: inch, cm",e.resolutionUnit)}return this._updateFormatOut("tiff",e)}function qa(e){return this.heif({...e,compression:"av1"})}function Ga(e){if(n.object(e)){if(n.string(e.compression)&&n.inArray(e.compression,["av1","hevc"]))this.options.heifCompression=e.compression;else throw n.invalidParameterError("compression","one of: av1, hevc",e.compression);if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.heifQuality=e.quality;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);if(n.defined(e.lossless))if(n.bool(e.lossless))this.options.heifLossless=e.lossless;else throw n.invalidParameterError("lossless","boolean",e.lossless);if(n.defined(e.effort))if(n.integer(e.effort)&&n.inRange(e.effort,0,9))this.options.heifEffort=e.effort;else throw n.invalidParameterError("effort","integer between 0 and 9",e.effort);if(n.defined(e.chromaSubsampling))if(n.string(e.chromaSubsampling)&&n.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))this.options.heifChromaSubsampling=e.chromaSubsampling;else throw n.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling);if(n.defined(e.bitdepth))if(n.integer(e.bitdepth)&&n.inArray(e.bitdepth,[8,10,12])){if(e.bitdepth!==8&&this.constructor.versions.heif)throw n.invalidParameterError("bitdepth when using prebuilt binaries",8,e.bitdepth);this.options.heifBitdepth=e.bitdepth}else throw n.invalidParameterError("bitdepth","8, 10 or 12",e.bitdepth)}else throw n.invalidParameterError("options","Object",e);return this._updateFormatOut("heif",e)}function Ua(e){if(n.object(e)){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.jxlDistance=e.quality>=30?.1+(100-e.quality)*.09:53/3e3*e.quality*e.quality-23/20*e.quality+25;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);else if(n.defined(e.distance))if(n.number(e.distance)&&n.inRange(e.distance,0,15))this.options.jxlDistance=e.distance;else throw n.invalidParameterError("distance","number between 0.0 and 15.0",e.distance);if(n.defined(e.decodingTier))if(n.integer(e.decodingTier)&&n.inRange(e.decodingTier,0,4))this.options.jxlDecodingTier=e.decodingTier;else throw n.invalidParameterError("decodingTier","integer between 0 and 4",e.decodingTier);if(n.defined(e.lossless))if(n.bool(e.lossless))this.options.jxlLossless=e.lossless;else throw n.invalidParameterError("lossless","boolean",e.lossless);if(n.defined(e.effort))if(n.integer(e.effort)&&n.inRange(e.effort,3,9))this.options.jxlEffort=e.effort;else throw n.invalidParameterError("effort","integer between 3 and 9",e.effort)}return this._updateFormatOut("jxl",e)}function Wa(e){if(n.object(e)&&n.defined(e.depth))if(n.string(e.depth)&&n.inArray(e.depth,["char","uchar","short","ushort","int","uint","float","complex","double","dpcomplex"]))this.options.rawDepth=e.depth;else throw n.invalidParameterError("depth","one of: char, uchar, short, ushort, int, uint, float, complex, double, dpcomplex",e.depth);return this._updateFormatOut("raw")}function Ha(e){if(n.object(e)){if(n.defined(e.size))if(n.integer(e.size)&&n.inRange(e.size,1,8192))this.options.tileSize=e.size;else throw n.invalidParameterError("size","integer between 1 and 8192",e.size);if(n.defined(e.overlap))if(n.integer(e.overlap)&&n.inRange(e.overlap,0,8192)){if(e.overlap>this.options.tileSize)throw n.invalidParameterError("overlap",`<= size (${this.options.tileSize})`,e.overlap);this.options.tileOverlap=e.overlap}else throw n.invalidParameterError("overlap","integer between 0 and 8192",e.overlap);if(n.defined(e.container))if(n.string(e.container)&&n.inArray(e.container,["fs","zip"]))this.options.tileContainer=e.container;else throw n.invalidParameterError("container","one of: fs, zip",e.container);if(n.defined(e.layout))if(n.string(e.layout)&&n.inArray(e.layout,["dz","google","iiif","iiif3","zoomify"]))this.options.tileLayout=e.layout;else throw n.invalidParameterError("layout","one of: dz, google, iiif, iiif3, zoomify",e.layout);if(n.defined(e.angle))if(n.integer(e.angle)&&!(e.angle%90))this.options.tileAngle=e.angle;else throw n.invalidParameterError("angle","positive/negative multiple of 90",e.angle);if(this._setBackgroundColourOption("tileBackground",e.background),n.defined(e.depth))if(n.string(e.depth)&&n.inArray(e.depth,["onepixel","onetile","one"]))this.options.tileDepth=e.depth;else throw n.invalidParameterError("depth","one of: onepixel, onetile, one",e.depth);if(n.defined(e.skipBlanks))if(n.integer(e.skipBlanks)&&n.inRange(e.skipBlanks,-1,65535))this.options.tileSkipBlanks=e.skipBlanks;else throw n.invalidParameterError("skipBlanks","integer between -1 and 255/65535",e.skipBlanks);else n.defined(e.layout)&&e.layout==="google"&&(this.options.tileSkipBlanks=5);const t=n.bool(e.center)?e.center:e.centre;if(n.defined(t)&&this._setBooleanOption("tileCentre",t),n.defined(e.id))if(n.string(e.id))this.options.tileId=e.id;else throw n.invalidParameterError("id","string",e.id);if(n.defined(e.basename))if(n.string(e.basename))this.options.tileBasename=e.basename;else throw n.invalidParameterError("basename","string",e.basename)}if(n.inArray(this.options.formatOut,["jpeg","png","webp"]))this.options.tileFormat=this.options.formatOut;else if(this.options.formatOut!=="input")throw n.invalidParameterError("format","one of: jpeg, png, webp",this.options.formatOut);return this._updateFormatOut("dz")}function Xa(e){if(!n.plainObject(e))throw n.invalidParameterError("options","object",e);if(n.integer(e.seconds)&&n.inRange(e.seconds,0,3600))this.options.timeoutSeconds=e.seconds;else throw n.invalidParameterError("seconds","integer between 0 and 3600",e.seconds);return this}function Qa(e,t){return n.object(t)&&t.force===!1||(this.options.formatOut=e),this}function Va(e,t){if(n.bool(t))this.options[e]=t;else throw n.invalidParameterError(e,"boolean",t)}function Ja(){if(!this.options.streamOut){this.options.streamOut=!0;const e=Error();this._pipeline(void 0,e)}}function Ya(e,t){return typeof e=="function"?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),de.pipeline(this.options,(i,r,o)=>{i?e(n.nativeError(i,t)):e(null,r,o)})}):de.pipeline(this.options,(i,r,o)=>{i?e(n.nativeError(i,t)):e(null,r,o)}),this):this.options.streamOut?(this._isStreamInput()?(this.once("finish",()=>{this._flattenBufferIn(),de.pipeline(this.options,(i,r,o)=>{i?this.emit("error",n.nativeError(i,t)):(this.emit("info",o),this.push(r)),this.push(null),this.on("end",()=>this.emit("close"))})}),this.streamInFinished&&this.emit("finish")):de.pipeline(this.options,(i,r,o)=>{i?this.emit("error",n.nativeError(i,t)):(this.emit("info",o),this.push(r)),this.push(null),this.on("end",()=>this.emit("close"))}),this):this._isStreamInput()?new Promise((i,r)=>{this.once("finish",()=>{this._flattenBufferIn(),de.pipeline(this.options,(o,a,s)=>{o?r(n.nativeError(o,t)):this.options.resolveWithObject?i({data:a,info:s}):i(a)})})}):new Promise((i,r)=>{de.pipeline(this.options,(o,a,s)=>{o?r(n.nativeError(o,t)):this.options.resolveWithObject?i({data:a,info:s}):i(a)})})}var Ka=function(e){Object.assign(e.prototype,{toFile:Ra,toBuffer:Ia,keepExif:Aa,withExif:ja,withExifMerge:$a,keepIccProfile:La,withIccProfile:Sa,keepMetadata:Ma,withMetadata:Na,toFormat:Ta,jpeg:Ca,jp2:Da,png:Ba,webp:_a,tiff:za,avif:qa,heif:Ga,jxl:Ua,gif:Fa,raw:Wa,tile:Ha,timeout:Xa,_updateFormatOut:Qa,_setBooleanOption:Va,_read:Ja,_pipeline:Ya})};const Za=W,Te=_e,_=H,{runtimePlatformArch:es}=Xt,N=Xe,fi=es(),nt=N.libvipsVersion(),Z=N.format();Z.heif.output.alias=["avif","heic"],Z.jpeg.output.alias=["jpe","jpg"],Z.tiff.output.alias=["tif"],Z.jp2k.output.alias=["j2c","j2k","jp2","jpx"];const ts={nearest:"nearest",bilinear:"bilinear",bicubic:"bicubic",locallyBoundedBicubic:"lbb",nohalo:"nohalo",vertexSplitQuadraticBasisSpline:"vsqbs"};let fe={vips:nt.semver};if(!nt.isGlobal)if(nt.isWasm)try{fe=require("@img/sharp-wasm32/versions")}catch{}else try{fe=ee(`@img/sharp-${fi}/versions`)}catch{try{fe=ee(`@img/sharp-libvips-${fi}/versions`)}catch{}}fe.sharp=Bt.version,fe.heif&&Z.heif&&(Z.heif.input.fileSuffix=[".avif"],Z.heif.output.alias=["avif"]);function mi(e){return _.bool(e)?e?N.cache(50,20,100):N.cache(0,0,0):_.object(e)?N.cache(e.memory,e.files,e.items):N.cache()}mi(!0);function is(e){return N.concurrency(_.integer(e)?e:null)}Te.familySync()===Te.GLIBC&&!N._isUsingJemalloc()?N.concurrency(1):Te.familySync()===Te.MUSL&&N.concurrency()===1024&&N.concurrency(W.availableParallelism());const rs=new Za.EventEmitter;function ns(){return N.counters()}function os(e){return N.simd(_.bool(e)?e:null)}function as(e){if(_.object(e))if(Array.isArray(e.operation)&&e.operation.every(_.string))N.block(e.operation,!0);else throw _.invalidParameterError("operation","Array<string>",e.operation);else throw _.invalidParameterError("options","object",e)}function ss(e){if(_.object(e))if(Array.isArray(e.operation)&&e.operation.every(_.string))N.block(e.operation,!1);else throw _.invalidParameterError("operation","Array<string>",e.operation);else throw _.invalidParameterError("options","object",e)}var ls=function(e){e.cache=mi,e.concurrency=is,e.counters=ns,e.simd=os,e.format=Z,e.interpolators=ts,e.versions=fe,e.queue=rs,e.block=as,e.unblock=ss};const Q=Kn;$o(Q),Bo(Q),Fo(Q),sa(Q),ba(Q),Oa(Q),Ka(Q),ls(Q);var hs=Q;const cs=Ri(hs),ps=Object.freeze(Object.defineProperty({__proto__:null,default:cs},Symbol.toStringTag,{value:"Module"}));export{ps as i};
