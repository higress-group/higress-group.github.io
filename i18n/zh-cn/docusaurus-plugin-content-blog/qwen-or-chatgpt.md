---
title: é€šä¹‰åƒé—®2.5â€œå®¢ä¸²â€ChatGPT4ï¼Œä½ åˆ†çš„æ¸…å—
keywords: [Higress,Wasm,AI,Qwen,ChatGPT,NextChat]
description: åŸºäºé€šä¹‰åƒé—®å¤§æ¨¡å‹ï¼Œä½¿ç”¨ Higress å’Œ NextChat æ­å»ºè·¨å¹³å°çš„ç§äºº ChatGPT åº”ç”¨
author: CH3CHO
date: 2024-05-11
---

## å¼•å­

OpenAI å‘å¸ƒäº†æœ€æ–°çš„ GPT-4o æ¨¡å‹ï¼Œé€šä¹‰åƒé—®ä¹Ÿåœ¨å‰ä¸ä¹…åˆšå‘å¸ƒé€šä¹‰åƒé—® 2.5ï¼Œå¹¶åœ¨ä¸­æ–‡åœºæ™¯å·²ç»å’Œ GPT-4-Turbo ä¸åˆ†ä¼¯ä»²ï¼š

![](https://img.alicdn.com/imgextra/i1/O1CN0148JrOd21va23GzrEb_!!6000000007047-0-tps-1080-813.jpg)

æ—¢ç„¶ç›®å‰è¿˜æ²¡æœ‰å’Œ GPT-4o æ–‡æœ¬ç”Ÿæˆèƒ½åŠ›çš„å¯¹æ¯”æ•°æ®ï¼Œå°±è®©æˆ‘ä»¬æ¥å’Œå¤§æ¨¡å‹ä¸€èµ·åšä¸ªæ¸¸æˆæµ‹è¯•ä¸€ä¸‹ï¼š

æˆ‘ä»¬è®©é€šä¹‰åƒé—® 2.5 æ‰®æ¼” GPT4ï¼Œæ¥å’ŒçœŸæ­£çš„ GPT4 è¿›è¡Œé—®ç­” PKï¼Œè¯»è€…ä¸å¦¨æ¥çŒœä¸€çŒœè°æ˜¯é€šä¹‰åƒé—®ã€‚

ä¸¤åé€‰æ‰‹çš„å¤´åƒå’Œæ˜µç§°åˆ†åˆ«æ˜¯ï¼š

ğŸŒ ï¼šæˆ‘æ˜¯GPT4

ğŸŒš ï¼šå¦‚å‡åŒ…æ¢GPT4

è°æ˜¯é€šä¹‰åƒé—®ï¼Œè°æ˜¯ChatGPTï¼Œç­”æ¡ˆå°†åœ¨æ–‡æœ«æ­æ™“ã€‚

## ç¬¬ä¸€è½®é—®ç­”

ç¬¬ä¸€è½®ç”±â€œæˆ‘æ˜¯GPT4â€é€‰æ‰‹æé—®ï¼Œç”±â€œå¦‚å‡åŒ…æ¢GPT4â€é€‰æ‰‹ä½œç­”

ğŸŒï¼šè§’è‰²è®¾å®š+ç¬¬ä¸€ä¸ªé—®é¢˜

![QA](https://img.alicdn.com/imgextra/i2/O1CN01RXt7bg1Pl5YpGvDHW_!!6000000001880-2-tps-855-480.png)

ğŸŒš ï¼šè§’è‰²è®¾å®š+ç¬¬ä¸€ä¸ªå›ç­”

![QA](https://img.alicdn.com/imgextra/i3/O1CN01UOHsOZ1tFt3GPBsRr_!!6000000005873-2-tps-855-422.png)

![QA](https://img.alicdn.com/imgextra/i2/O1CN01LJQ5zW1IOv4xlYt6k_!!6000000000884-2-tps-855-525.png)

ğŸŒ ï¼šç¬¬äºŒä¸ªé—®é¢˜

![QA](https://img.alicdn.com/imgextra/i3/O1CN01h0fgCS1WNupcRJqr3_!!6000000002777-2-tps-860-411.png)

ğŸŒš ï¼šç¬¬äºŒä¸ªå›ç­”

![QA](https://img.alicdn.com/imgextra/i3/O1CN01h4Oqhu1EeFsSfNVXZ_!!6000000000376-2-tps-855-507.png)

ğŸŒ ï¼šç¬¬ä¸‰ä¸ªé—®é¢˜

![QA](https://img.alicdn.com/imgextra/i3/O1CN01iD3xp32AAFe6pUMTY_!!6000000008162-2-tps-860-374.png)

ğŸŒš ï¼šç¬¬ä¸‰ä¸ªå›ç­”

![QA](https://img.alicdn.com/imgextra/i2/O1CN01yDu0m41r9oZFojWHF_!!6000000005589-2-tps-855-433.png)

## ç¬¬äºŒè½®é—®ç­”

ç¬¬äºŒè½®ç”±â€œå¦‚å‡åŒ…æ¢GPT4â€é€‰æ‰‹æé—®ï¼Œç”±â€œæˆ‘æ˜¯GPT4â€é€‰æ‰‹ä½œç­”

ğŸŒš ï¼šè§’è‰²è®¾å®š+ç¬¬ä¸€ä¸ªé—®é¢˜

![QA](https://img.alicdn.com/imgextra/i2/O1CN01v1PrMd1HrwYtq3N7x_!!6000000000812-2-tps-855-517.png)

ğŸŒ ï¼šè§’è‰²è®¾å®š+ç¬¬ä¸€ä¸ªå›ç­”

![QA](https://img.alicdn.com/imgextra/i4/O1CN01Jm4Ke81CjAtwWAz9g_!!6000000000116-2-tps-855-422.png)

![QA](https://img.alicdn.com/imgextra/i1/O1CN01CNkl9B1la1XSUOJIG_!!6000000004834-2-tps-855-441.png)

ğŸŒš ï¼šç¬¬äºŒä¸ªé—®é¢˜

![QA](https://img.alicdn.com/imgextra/i1/O1CN01lD1DTl1FgpitHnhmI_!!6000000000517-2-tps-860-353.png)

ğŸŒ ï¼šç¬¬äºŒä¸ªå›ç­”

![QA](https://img.alicdn.com/imgextra/i1/O1CN01v8g20421HjZh3EtET_!!6000000006960-2-tps-855-517.png)

ğŸŒš ï¼šç¬¬ä¸‰ä¸ªé—®é¢˜

![QA](https://img.alicdn.com/imgextra/i2/O1CN01Dbl4ub1UacaQ6vBlT_!!6000000002534-2-tps-860-353.png)

ğŸŒ ï¼šç¬¬ä¸‰ä¸ªå›ç­”

![QA](https://img.alicdn.com/imgextra/i2/O1CN01jDt0gk1SnKLN6Ay8W_!!6000000002291-2-tps-855-749.png)

## æµ‹è¯•åº”ç”¨ä»‹ç»

çœ‹å®Œä¸Šé¢è¿™äº›å¯¹è¯æˆªå›¾ï¼Œä¸çŸ¥é“å„ä½æ˜¯å¦æƒ³çŸ¥é“è¿™ä¸ªæµ‹è¯•åº”ç”¨åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒåˆæ˜¯å¦‚ä½•åŒæ—¶æ”¯æŒ ChatGPT å’Œé€šä¹‰åƒé—®ä¸¤ä¸ªå¤§æ¨¡å‹æœåŠ¡æä¾›å•†çš„å‘¢ï¼Ÿä¸‹é¢æˆ‘å°±æ¥ä¸ºå¤§å®¶ä»‹ç»ä¸€ä¸‹ã€‚

è¿™ä¸ªæµ‹è¯•è½¯ä»¶çš„ç•Œé¢éƒ¨åˆ†æ¥è‡ªäº [NextChat (ChatGPT Next Web)](https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web)ã€‚å®ƒæ˜¯ä¸€ä¸ªå¯ä»¥ç§æœ‰åŒ–éƒ¨ç½²çš„ ChatGPT ç½‘é¡µåº”ç”¨ï¼Œç›®å‰æ”¯æŒå¯¹æ¥ OpenAIã€Azure OpenAIã€Google Gemini Pro å’Œ Anthropic Claude è¿™äº›æœåŠ¡æä¾›å•†ã€‚

çœ‹äº†å¯¹ NextChat çš„ä»‹ç»ï¼Œå¤§å®¶ä¼šå‘ç°ï¼Œâ€œå®ƒå¹¶ä¸æ”¯æŒå¯¹æ¥é€šä¹‰åƒé—®å•Šï¼ä½ ä¸ä¼šæ ¹æœ¬å°±æ²¡æµ‹é€šä¹‰åƒé—®å§ï¼Ÿâ€é‚£å½“ç„¶ä¸ä¼šäº†ã€‚è¯´åˆ°å¯¹æ¥é€šä¹‰åƒé—®ï¼Œé‚£å°±è½®åˆ°æˆ‘ä»¬çš„ Higress å‡ºåœºäº†ã€‚

Higress æ˜¯åŸºäºé˜¿é‡Œå†…éƒ¨çš„ Envoy Gateway å®è·µæ²‰æ·€ã€ä»¥å¼€æº Istio + Envoy ä¸ºæ ¸å¿ƒæ„å»ºçš„äº‘åŸç”Ÿ API ç½‘å…³ã€‚åŸºäº Envoy æä¾›çš„ Wasm æ‰©å±•èƒ½åŠ›ï¼ŒHigress è¿‘æœŸæ¨å‡ºäº† AI æœåŠ¡ä»£ç†æ’ä»¶ã€‚è¿™ä¸€æ’ä»¶å¯ä»¥ç»Ÿä¸€å„ç§å¤§æ¨¡å‹æœåŠ¡æä¾›å•†å¯¹å¤–æš´éœ²çš„ä¸åŒæ¥å£å¥‘çº¦ï¼Œå¯¹å¤–ä»¥ OpenAI API çš„æ¥å£å¥‘çº¦å¯¹å¤–æä¾›æœåŠ¡ã€‚é€šè¿‡è°ƒæ•´è·¯ç”±è§„åˆ™å’Œæ’ä»¶é…ç½®ï¼Œç”¨æˆ·å¯ä»¥å¾ˆæ–¹ä¾¿çš„åœ¨ä¸åŒçš„å¤§æ¨¡å‹æœåŠ¡æä¾›å•†ä¹‹é—´è¿›è¡Œåˆ‡æ¢ã€‚

è™½ç„¶è¢«ç§°ä½œäº‘åŸç”Ÿç½‘å…³ï¼Œä½† Higress ä¸ä»…èƒ½åœ¨ K8s ä¸­éƒ¨ç½²ï¼Œå®ƒè¿˜å¯ä»¥ä»¥å•ä¸€å®¹å™¨é…åˆé…ç½®æ–‡ä»¶çš„å½¢å¼è¿è¡Œã€‚è€Œæœ¬æ¬¡æµ‹è¯•å°±åˆ©ç”¨äº† Higress çš„è¿™ä¸€èƒ½åŠ›ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹è¿™ä¸ªæµ‹è¯•å¹³å°å…·ä½“æ˜¯å¦‚ä½•æ­å»ºèµ·æ¥çš„ã€‚

## æµ‹è¯•å¹³å°æ­å»º

**ç¬¬ä¸€æ­¥ï¼š**åˆ›å»ºä¸€ä¸ªåä¸º `docker-compose.yml` çš„æ–‡ä»¶ï¼Œå¹¶å¡«å…¥ä»¥ä¸‹å†…å®¹ï¼š

> æ³¨æ„ï¼š
> 1. `YOUR_DASHSCOPE_API_KEY` éœ€è¦æ›¿æ¢ä¸ºä½ è‡ªå·±çš„é€šä¹‰åƒé—®çš„ API Keyï¼›
> 2. `/path-to-local-config-folder` éœ€è¦æ›¿æ¢ä¸ºä¸€ä¸ªæœ¬åœ°å¯ä»¥ç”¨æ¥ä¿å­˜é…ç½®æ–‡ä»¶çš„ç›®å½•è·¯å¾„ã€‚

```yaml
version: '3.9'

networks:
  higress-net:
    external: false

services:
  higress:
    image: higress-registry.cn-hangzhou.cr.aliyuncs.com/higress/all-in-one:1.3.6
    environment:
      - MODE=gateway
      - CONFIG_TEMPLATE=ai-proxy
      - DEFAULT_AI_SERVICE=qwen
      - DASHSCOPE_API_KEY=YOUR_DASHSCOPE_API_KEY
    networks:
      - higress-net
    ports:
      - "8080:8080/tcp"
      - "8001:8001/tcp"
    volumes:
      - /path-to-local-config-folder:/data
    restart: always
  nextchat:
    image: yidadaa/chatgpt-next-web
    environment:
      - OPENAI_API_KEY=unused
      - BASE_URL=http://higress:8080
    networks:
      - higress-net
    ports:
      - "3000:3000/tcp"
    restart: always
```

**ç¬¬äºŒæ­¥ï¼š**åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¯åŠ¨ docker compose é¡¹ç›®ï¼š

```bash
docker compose -p higress-ai up -d
```

**ç¬¬ä¸‰æ­¥ï¼š**åœ¨æµè§ˆå™¨é‡Œè®¿é—® http://localhost:3000/ï¼Œæ‰“å¼€ NextChat é¡µé¢ï¼›

![nextchat-homepage](../../../static/img/blog/qwen-or-chatgpt/nextchat-homepage.png)

**ç¬¬å››æ­¥ï¼š**ç‚¹å‡»å¯¹è¯è¾“å…¥æ¡†å·¥å…·æ æœ€å³ä¾§çš„æ¨¡å‹è®¾ç½®æŒ‰é’®ï¼Œå°†æ¨¡å‹åˆ‡æ¢ä¸º `gpt-4-turbo` å¹¶å…³é—­çª—å£ã€‚

![nextchat-model-setting](../../../static/img/blog/qwen-or-chatgpt/nextchat-model-setting.png)

**å®Œæˆï¼**ç°åœ¨ä½ å°±å¯ä»¥ä¸ AI è¿›è¡Œå¯¹è¯äº†ã€‚

![nextchat-first-msg](../../../static/img/blog/qwen-or-chatgpt/nextchat-first-msg.png)

æŒ‰ç…§ä¸Šé¢æ–‡ä»¶è¿›è¡Œé…ç½®ï¼Œé»˜è®¤å’Œä½ å¯¹è¯çš„å°†æ˜¯é€šä¹‰åƒé—®ã€‚å¦‚æœæƒ³åˆ‡æ¢åˆ°OpenAI ChatGPTï¼Œåªéœ€è¦å°†æ–‡ä»¶ä¸­çš„ `DEFAULT_AI_SERVICE=qwen` ä¿®æ”¹ä¸º `DEFAULT_AI_SERVICE=openai`ï¼Œå¹¶æ·»åŠ  OpenAI çš„ API key é…ç½®ï¼Œç„¶åé‡æ–°å¯åŠ¨ docker compose é¡¹ç›®å³å¯ã€‚

```yaml
# ä»¥ä¸Šé…ç½®çœç•¥
  higress:
    image: higress-registry.cn-hangzhou.cr.aliyuncs.com/higress/all-in-one:1.3.6
    environment:
      - MODE=gateway
      - CONFIG_TEMPLATE=ai-proxy
      - DEFAULT_AI_SERVICE=openai
      - OPENAI_API_KEY=YOUR_OPENAI_API_KEY
# ä»¥ä¸‹é…ç½®çœç•¥
```

```bash
docker compose -p higress-ai down
docker compose -p higress-ai up -d
```

æ•´ä¸ªæµç¨‹æ˜¯ä¸æ˜¯å¾ˆç®€å•å‘¢ï¼Ÿæ¬¢è¿å„ä½ä¹Ÿåœ¨æœ¬åœ°å°è¯•ä¸€ä¸‹ã€‚

## Higress AI ä»£ç†æ’ä»¶ä»‹ç»

ä»ä¸Šé¢çš„æ­å»ºæµç¨‹æ¥çœ‹ï¼ŒHigress AI ä»£ç†æ’ä»¶å¯ä»¥å¾ˆæ–¹ä¾¿çš„è®© AI å¯¹è¯åº”ç”¨ç›´æ¥å¯¹æ¥é€šä¹‰åƒé—®ç­‰æ¥å£å¥‘çº¦ä¸åŒçš„å¤§æ¨¡å‹æœåŠ¡ã€‚é™¤äº†é€šä¹‰åƒé—®å’Œ ChatGPT ä¹‹å¤–ï¼Œè¿™ä¸ªæ’ä»¶è¿˜æ”¯æŒ Azure OpenAI å’Œæœˆä¹‹æš—é¢ï¼ˆMoonshotï¼‰ç­‰å¤§æ¨¡å‹æœåŠ¡æä¾›å•†ï¼Œå¹¶ä¸”æ”¯æŒé…ç½®ä¸€ä¸ªå¤–éƒ¨æ–‡ä»¶åœ°å€ä½œä¸ºèŠå¤©ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥ç”¨æ¥å¿«é€Ÿæ­å»ºä¸€ä¸ªä¸ªäºº AI åŠ©ç†æœåŠ¡ã€‚

æ•´ä¸ªæ’ä»¶ä½¿ç”¨ Go è¯­è¨€è¿›è¡Œå¼€å‘ï¼Œå……åˆ†åˆ©ç”¨äº† Proxy Wasm SDK æä¾›çš„å„ç§é€»è¾‘æ³¨å…¥ç‚¹æ¥å¯¹è¯·æ±‚å’Œå“åº”æ ‡å¤´å’Œæ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œä»¥å®ç°ç»Ÿä¸€çš„ AI æœåŠ¡ç½‘å…³åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼šæ³¨å…¥ API keyã€æ³¨å…¥ä¸Šä¸‹æ–‡æç¤ºè¯ã€æ¥å£å¥‘çº¦æ ¼å¼è½¬æ¢ç­‰ã€‚å°¤å…¶æ˜¯åœ¨å¯¹æ¥é€šä¹‰åƒé—®çš„æ—¶å€™ï¼Œç”±äºå®ƒä½¿ç”¨çš„æ¥å£å¥‘çº¦ä¸åŒï¼Œæ‰€ä»¥æ’ä»¶éœ€è¦å®ç°å¯¹åº”çš„æ•°æ®æ¨¡å‹è½¬æ¢é€»è¾‘ã€‚ç°åœ¨ AI ä»£ç†æ’ä»¶å·²ç»å®Œå…¨æ”¯æŒä½¿ç”¨ OpenAI åè®®æ¥æµå¼è¿”å›é€šä¹‰åƒé—®çš„å“åº”æ•°æ®ã€‚

æ’ä»¶é…ç½®ç¤ºä¾‹ï¼š

```yaml
apiVersion: extensions.higress.io/v1alpha1
kind: WasmPlugin
metadata:
  annotations:
    higress.io/wasm-plugin-title: AI Proxy
  labels:
    higress.io/resource-definer: higress
    higress.io/wasm-plugin-built-in: "false"
    higress.io/wasm-plugin-category: custom
    higress.io/wasm-plugin-name: ai-proxy
    higress.io/wasm-plugin-version: "0.0.1"
  name: ai-proxy-0.0.1
  namespace: higress-system
spec:
  defaultConfig: {}
  defaultConfigDisable: true
  matchRules:
  - config:
      provider:
        type: qwen
        apiToken: YOUR_DASHSCOPE_API_KEY
        protocol: openai # å¦‚æœè¦ç»§ç»­ä½¿ç”¨é€šä¹‰åƒé—®æœ¬æ¥çš„æ¥å£å¥‘çº¦ï¼Œå¯ä»¥å°†è¿™é‡Œæ”¹ä¸º "original"
        modelMapping:
          '*': "qwen-turbo"
          'gpt-3': "qwen-turbo"
          'gpt-35-turbo': "qwen-plus"
          'gpt-4-turbo': "qwen-max"
    configDisable: false
    ingress:
    - qwen
  - config:
      provider:
        type: azure
        apiToken: YOUR_AZURE_OPENAI_API_KEY
        azureServiceUrl: https://YOUR_RESOURCE_NAME.openai.azure.com/openai/deployments/YOUR_DEPLOYMENT_NAME/chat/completions?api-version=2024-02-01
    configDisable: false
    ingress:
    - azure-openai
  - config:
      provider:
        type: openai
        apiToken: YOUR_OPENAI_API_KEY
    configDisable: false
    ingress:
    - openai
  - config:
      provider:
        type: moonshot
        apiToken: YOUR_MOONSHOT_API_KEY
        modelMapping:
          '*': "moonshot-v1-8k"
          'gpt-3': "moonshot-v1-8k"
          'gpt-35-turbo': "moonshot-v1-32k"
          'gpt-4-turbo': "moonshot-v1-128k"
    configDisable: false
    ingress:
    - moonshot
  phase: UNSPECIFIED_PHASE
  priority: "100"
  url: oci://higress-registry.cn-hangzhou.cr.aliyuncs.com/plugins/ai-proxy:0.0.1
```

å¦‚æœå¤§å®¶æœ‰ä»»ä½•éœ€æ±‚ï¼Œä¹Ÿå¯ä»¥å¯¹è¿™ä¸ªæ’ä»¶è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œæ¯”å¦‚å¯¹æ¥æ–°çš„å¤§æ¨¡å‹æœåŠ¡ï¼Œè‡ªå®šä¹‰ system prompt ç­‰ç­‰ã€‚åŒæ—¶ä¹Ÿæ¬¢è¿å¤§å®¶æŠŠè‡ªå·±å¼€å‘çš„åŠŸèƒ½è´¡çŒ®ç»™ç¤¾åŒºï¼Œé€ ç¦æ‰€æœ‰ Higress çš„ç”¨æˆ·ã€‚

æ­¤å¤–ï¼Œç”±ä¸­å›½ç§‘å­¦é™¢è½¯ä»¶ç ”ç©¶æ‰€â€œå¼€æºè½¯ä»¶ä¾›åº”é“¾ç‚¹äº®è®¡åˆ’â€å‘èµ·å¹¶é•¿æœŸæ”¯æŒçš„æš‘æœŸå¼€æºæ´»åŠ¨â€œå¼€æºä¹‹å¤â€æ­£åœ¨è¿›è¡Œä¸­ã€‚Higress ä¹Ÿæœ‰ä¸¤ä¸ªä¸ AI ç›¸å…³çš„é¡¹ç›®å‚ä¸å…¶ä¸­ï¼Œåˆ†åˆ«æ˜¯â€œå®ç°åŸºäºå‘é‡ç›¸ä¼¼åº¦å®ç°LLMç»“æœå¬å›çš„WASMæ’ä»¶â€å’Œâ€œåŸºäºAIç½‘å…³å®ç°AIæ¨¡å‹çš„è½»é‡åŒ–éƒ¨ç½²â€ã€‚æ¬¢è¿å„ä½åœ¨æ ¡åŒå­¦ç§¯ææŠ¥åå‚ä¸ã€‚è¯¦æƒ…å¯æŸ¥çœ‹å¼€æºä¹‹å¤çš„ [Higress ç¤¾åŒºé¡µé¢](https://summer-ospp.ac.cn/org/orgdetail/1f8ea42c-86c9-46b8-b1f5-344de5741ef0)ã€‚

## ç­”æ¡ˆæ­æ™“

æœ€åï¼Œæˆ‘ä»¬æ¥æ­æ™“å‰é¢é—®é¢˜çš„ç­”æ¡ˆã€‚ä¸çŸ¥é“å„ä½çŒœå¯¹äº†å—ï¼Ÿ

<!-- ![qns-1m](../../../static/img/blog/qwen-or-chatgpt/1m.png)

![qns-2m](../../../static/img/blog/qwen-or-chatgpt/2m.png)

![qns-3m](../../../static/img/blog/qwen-or-chatgpt/3m.png)

![qns-4m](../../../static/img/blog/qwen-or-chatgpt/4m.png)

![qns-5m](../../../static/img/blog/qwen-or-chatgpt/5m.png)

![qns-6m](../../../static/img/blog/qwen-or-chatgpt/6m.png) -->
