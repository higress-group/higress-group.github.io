---
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const docs = await getCollection('docs');

  // Find all docs under docs/latest/
  const latestDocs = docs.filter(doc => doc.slug.startsWith('docs/latest/'));

  return latestDocs.map(doc => {
    const slug = doc.slug.replace(/^docs\/latest\//, '');
    return {
      params: { slug },
      props: { destination: `/docs/latest/${slug}/` },
    };
  });
}

const { destination } = Astro.props;
return Astro.redirect(destination);
---
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="refresh" content={`0;url=${destination}`}>
  <meta name="robots" content="noindex">
  <link rel="canonical" href={destination}>
  <title>Redirecting...</title>
</head>
<body>
  <p>Redirecting to <a href={destination}>{destination}</a></p>
</body>
</html>
