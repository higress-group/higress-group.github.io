<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="Ingress" />
	<meta name="description" content="Higress Ingress Annotaion 配置说明。" />
	<meta name="aes-config" content="pid=xux-opensource&user_type=101&uid=&username=&dim10=higress"/>
	<!-- 网页标签标题 -->
	<title>Ingress Annotaion 配置说明</title>
  <link rel="shortcut icon" href="/img/higress_logo_small.jpg"/>
	<link rel="stylesheet" href="/build/documentation.css" />
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot=""><header class="header-container header-container-normal"><div class="header-body"><a href="/zh-cn/index.html"><img class="logo" src="//img.alicdn.com/imgextra/i1/O1CN01I7WjVs1K33EQjInid_!!6000000001107-2-tps-960-290.png"/></a><div class="search search-normal"><span class="icon-search"></span></div><span class="language-switch language-switch-normal">En</span><div class="header-menu"><img class="header-menu-toggle" src="https://img.alicdn.com/tfs/TB14eEmw7P2gK0jSZPxXXacQpXa-38-32.png"/><ul><li class="menu-item menu-item-normal"><span><a href="/zh-cn/index.html">首页</a></span></li><li class="menu-item menu-item-normal menu-item-normal-active"><span><a href="/zh-cn/docs/overview/what-is-higress.html">文档</a></span></li><li class="menu-item menu-item-normal"><span><a href="/zh-cn/docs/developers/developers_dev.html">开发者</a></span></li><li class="menu-item menu-item-normal"><span><a href="/zh-cn/blog/index.html">博客</a></span></li><li class="menu-item menu-item-normal"><span><a href="/zh-cn/community/index.html">社区</a></span></li><li class="menu-item menu-item-normal"><span><a href="/zh-cn/blog/download.html">下载</a></span></li></ul></div></div></header><div class="bar"><div class="bar-body"><img src="https://img.alicdn.com/tfs/TB1cm8nJwDqK1RjSZSyXXaxEVXa-160-160.png" class="front-img"/><span>文档</span><img src="https://img.alicdn.com/tfs/TB1cm8nJwDqK1RjSZSyXXaxEVXa-160-160.png" class="back-img"/></div></div><section class="content-section"><div class="sidemenu"><div class="sidemenu-toggle"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png"/></div><ul><li class="menu-item menu-item-level-1"><span>概述</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/overview/what-is-higress.html" target="_self">Higress 是什么？</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/overview/roadmap.html" target="_self">Roadmap</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/overview/faq.html" target="_self">FAQ</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/overview/terminology.html" target="_self">术语表</a></li></ul></li><li class="menu-item menu-item-level-1"><span>用户指南</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/user/quickstart.html" target="_self">快速开始</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>最佳实践示例<img style="transform:rotate(-90deg)" class="menu-toggle" src="https://img.alicdn.com/tfs/TB15.Ilw2b2gK0jSZK9XXaEgFXa-26-16.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/user/wasm-go.html" target="_self">使用 GO 语言开发 WASM 插件</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/user/dubbo.html" target="_self">实现 Dubbo 服务发现和路由</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>文档陆续增加中...<img style="transform:rotate(-90deg)" class="menu-toggle" src="https://img.alicdn.com/tfs/TB15.Ilw2b2gK0jSZK9XXaEgFXa-26-16.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/user/nacos-route.html" target="_self">配置 Ingress 转发给注册在 Nacos 的服务</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/user/spring-cloud.html" target="_self">实现 SpringCloud 服务发现和路由</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/user/prometheus.html" target="_self">基于 Prometheus 实现入口流量观测</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/user/kruise-rollout.html" target="_self">通过 OpenKruise Rollout 实现灰度发布</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/user/opensergo-gray.html" target="_self">对接 OpenSergo 实现全链路灰度</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/user/sentinel.html" target="_self">基于 Sentinel 实现入口熔断限流</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/user/waf.html" target="_self">开启 WAF 防护的最佳实践</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>参考手册<img style="transform:rotate(-90deg)" class="menu-toggle" src="https://img.alicdn.com/tfs/TB15.Ilw2b2gK0jSZK9XXaEgFXa-26-16.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/user/annotation.html" target="_self">Ingress Annotaion 配置说明</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/user/configurations.html" target="_self">运维参数配置说明</a></li><li class="menu-item menu-item-level-3"><a href="/zh-cn/docs/user/mcp-bridge.html" target="_self">Mcp Brdige 配置说明</a></li></ul></li></ul></li><li class="menu-item menu-item-level-1"><span>运维指南</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/ops/deploy-by-helm.html" target="_self">安装部署</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/ops/upgrade.html" target="_self">版本升级</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/ops/log.html" target="_self">日志说明</a></li></ul></li><li class="menu-item menu-item-level-1"><span>开发者指南</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/dev/code.html" target="_self">源码阅读指引</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/dev/architecture.html" target="_self">组件编译说明</a></li></ul></li></ul></div><div class="doc-content markdown-body"><h1>Ingress Annotaion 配置说明</h1>
<p>标准的K8s Ingress资源只能处理简单场景下的HTTP(S)流量路由，无法处理流量切分，超时重试，Header控制和跨域等问题。因此，不同的Ingress Controller利用自定义的Ingress Annotation增强Ingress能力。常见的Nginx Ingress Controller引入了100多个Annotation对Ingress在流量治理和安全防护上进行了扩展实现。目前，Higress已经全面兼容了大部分Nginx Ingress Annotation，方便用户从Nginx Ingress无缝迁移至Higress，本文主要介绍Higress关于Ingress Annotation的配置说明。</p>
<h2>Ingress Annotation</h2>
<h3>特殊说明</h3>
<h4>Annotation Key 前缀</h4>
<p>以下出现的Nginx Ingress Annotation都已被Higress支持，您可以根据使用习惯继续使用Nginx Ingress的Annotation前缀<code>nginx.ingress.kubernetes.io</code>，或者使用Higress Ingress的Annotation前缀<code>higress.io</code>，两者是等价的。</p>
<h4>作用域说明</h4>
<ul>
<li>Ingress：作用域为Ingress的Annotation的作用范围仅限当前Ingress上定义的路由规则。</li>
<li>域名：作用域为域名的Annotation，其作用范围为所有Ingress上出现的相同Host。</li>
<li>服务：作用域为服务的Annotation，其作用范围为所有Ingress上出现的相同Service。</li>
</ul>
<h3>流量治理</h3>
<h4>灰度发布</h4>
<table>
<thead>
<tr>
<th>注解</th>
<th>作用域</th>
<th>支持度</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/canary">nginx.ingress.kubernetes.io/canary</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>开启或关闭灰度发布</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/canary-by-header">nginx.ingress.kubernetes.io/canary-by-header</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>基于Request Header Key 流量切分</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/canary-by-header-value">nginx.ingress.kubernetes.io/canary-by-header-value</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>基于Request Header Value 流量切分，Value为精确匹配</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/canary-by-header-pattern">nginx.ingress.kubernetes.io/canary-by-header-pattern</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>基于Request Header Value 流量切分，Value为正则匹配</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/canary-by-cookie">nginx.ingress.kubernetes.io/canary-by-cookie</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>基于Request Cookie Key 流量切分</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/canary-weight">nginx.ingress.kubernetes.io/canary-weight</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>基于权重 流量切分</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/canary-weight-total">nginx.ingress.kubernetes.io/canary-weight-total</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>权重总和</td>
</tr>
</tbody>
</table>
<h4>Fallback（容灾）</h4>
<table>
<thead>
<tr>
<th>注解</th>
<th>作用域</th>
<th>支持度</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/default-backend">nginx.ingress.kubernetes.io/default-backend</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>容灾服务。当Ingress定义的服务没有可用节点时，请求会自动转发该容灾服务。</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/custom-http-errors">nginx.ingress.kubernetes.io/custom-http-errors</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>该注解和<code>default-backend</code>一起工作。当后端服务返回指定HTTP响应码，原始请求会被再次转发至容灾服务。<br> &gt; 注意：转发至容灾服务时，请求的Path会被重写为/，该行为与ingress-nginx保持一致</td>
</tr>
</tbody>
</table>
<h4>重写</h4>
<table>
<thead>
<tr>
<th>注解</th>
<th>作用域</th>
<th>支持度</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/rewrite-target">nginx.ingress.kubernetes.io/rewrite-target</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>将Ingress定义的原path重写为指定目标，支持Group Capture.</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/upstream-vhost">nginx.ingress.kubernetes.io/upstream-vhost</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>匹配Ingress定义的路由的请求在转发给后端服务时，修改头部host值为指定值。</td>
</tr>
</tbody>
</table>
<h4>重定向</h4>
<table>
<thead>
<tr>
<th>注解</th>
<th>作用域</th>
<th>支持度</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/ssl-redirect">nginx.ingress.kubernetes.io/ssl-redirect</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>HTTP 重定向为HTTPS</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/force-ssl-redirect">nginx.ingress.kubernetes.io/force-ssl-redirect</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>HTTP 重定向为HTTPS</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/permanent-redirect">nginx.ingress.kubernetes.io/permanent-redirect</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>永久重定向</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/permanent-redirect-code">nginx.ingress.kubernetes.io/permanent-redirect-code</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>永久重定向状态码</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/temporal-redirect">nginx.ingress.kubernetes.io/temporal-redirect</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>临时重定向</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/app-root">nginx.ingress.kubernetes.io/app-root</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>修改应用根路径，对于访问/的请求将会被重定向为设置的新路径</td>
</tr>
</tbody>
</table>
<h4>跨域</h4>
<table>
<thead>
<tr>
<th>注解</th>
<th>作用域</th>
<th>支持度</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/enable-cors">nginx.ingress.kubernetes.io/enable-cors</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>开启或关闭跨域</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/cors-allow-origin">nginx.ingress.kubernetes.io/cors-allow-origin</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>允许的第三方站点</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/cors-allow-methods">nginx.ingress.kubernetes.io/cors-allow-methods</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>允许的请求方法，如GET、POST、PUT等</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/cors-allow-headers">nginx.ingress.kubernetes.io/cors-allow-headers</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>允许的请求Header</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/cors-expose-headers">nginx.ingress.kubernetes.io/cors-expose-headers</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>允许的暴露给浏览器的响应Header</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/cors-allow-credentials">nginx.ingress.kubernetes.io/cors-allow-credentials</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>是否允许携带凭证信息</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/cors-max-age">nginx.ingress.kubernetes.io/cors-max-age</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>预检结果的最大缓存时间</td>
</tr>
</tbody>
</table>
<h4>重试</h4>
<table>
<thead>
<tr>
<th>注解</th>
<th>作用域</th>
<th>支持度</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/proxy-next-upstream-tries">nginx.ingress.kubernetes.io/proxy-next-upstream-tries</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>请求的最大重试次数。默认3次。</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/proxy-next-upstream-timeout">nginx.ingress.kubernetes.io/proxy-next-upstream-timeout</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>请求重试的超时时间，单位秒。默认未配置超时时间。</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/proxy-next-upstream">nginx.ingress.kubernetes.io/proxy-next-upstream</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>请求重试条件，参考<a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_next_upstream">http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_next_upstream</a></td>
</tr>
</tbody>
</table>
<h4>后端服务使用的协议</h4>
<table>
<thead>
<tr>
<th>注解</th>
<th>作用域</th>
<th>支持度</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/backend-protocol">nginx.ingress.kubernetes.io/backend-protocol</a></td>
<td>服务</td>
<td>部分兼容。不支持AJP和FCGI</td>
<td>指定后端服务使用的协议，默认为HTTP，支持HTTP、HTTP2、HTTPS、GRPC和GRPCS</td>
</tr>
</tbody>
</table>
<h4>负载均衡</h4>
<table>
<thead>
<tr>
<th>注解</th>
<th>作用域</th>
<th>支持度</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/load-balance">nginx.ingress.kubernetes.io/load-balance</a></td>
<td>服务</td>
<td>部分兼容。不支持<code>ewma</code>算法</td>
<td>后端服务的普通负载均衡算法。默认为round_robin。 <br>合法值如下：<br>- round_robin：基于轮询的负载均衡。<br>- least_conn：基于最小请求数的负载均衡。<br>- random：基于随机的负载均衡。<br> &gt; 注意：Higress不支持ewma算法，若配置为ewma算法，会回退到round_robin算法。</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/upstream-hash-by">nginx.ingress.kubernetes.io/upstream-hash-by</a></td>
<td>服务</td>
<td>部分兼容。暂不支持Nginx变量、常量的组合使用方式</td>
<td>基于一致Hash的负载均衡算法，Higress支持以下几种形式：<br>1. Higress支持配置部分nginx变量：<br>- $request_uri：请求的Path（包括路径参数）作为Hash Key <br>- $host：请求的Host作为Hash Key<br>- remote_addr：请求的客户端IP作为Hash Key。<br>2. 基于请求header的一致性Hash。您只需配置为http_headerName。<br>3. 基于请求路径参数的一致性Hash。您只需配置为$arg_varName</td>
</tr>
</tbody>
</table>
<h4>Cookie亲和性</h4>
<table>
<thead>
<tr>
<th>注解</th>
<th>作用</th>
<th>支持度</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/affinity">nginx.ingress.kubernetes.io/affinity</a></td>
<td>服务</td>
<td>兼容</td>
<td>亲和性种类，目前只支持cookie，默认为cookie。</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/affinity-mode">nginx.ingress.kubernetes.io/affinity-mode</a></td>
<td>服务</td>
<td>部分兼容。暂不支持<code>persistent</code>模式</td>
<td>亲和性模式，云原生网关目前只支持balanced模式，默认为balanced模式。</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/session-cookie-name">nginx.ingress.kubernetes.io/session-cookie-name</a></td>
<td>服务</td>
<td>兼容</td>
<td>配置指定Cookie的值作为Hash Key</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/session">nginx.ingress.kubernetes.io/session</a></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>-cookie-path</td>
<td>服务</td>
<td>兼容</td>
<td>当指定Cookie不存在，生成的Cookie的Path值，默认为/</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/session-cookie-max-age">nginx.ingress.kubernetes.io/session-cookie-max-age</a></td>
<td>服务</td>
<td>兼容</td>
<td>当指定Cookie不存在，生成的Cookie的过期时间，单位为秒，默认为Session会话级别。</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/session-cookie-expires">nginx.ingress.kubernetes.io/session-cookie-expires</a></td>
<td>服务</td>
<td>兼容</td>
<td>当指定Cookie不存在，生成的Cookie的过期时间，单位为秒，默认为Session会话级别。</td>
</tr>
</tbody>
</table>
<h4>IP访问控制</h4>
<table>
<thead>
<tr>
<th>注解</th>
<th>作用域</th>
<th>支持度</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/">nginx.ingress.kubernetes.io/</a><a href="https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/#whitelist-source-range">whitelist-source-range</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>指定路由上的IP白名单，支持IP地址或CIDR地址块，以逗号分隔。</td>
</tr>
</tbody>
</table>
<h3>安全防护</h3>
<h4>客户端与网关之前的通信加密</h4>
<table>
<thead>
<tr>
<th>注解</th>
<th>作用域</th>
<th>支持度</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/ssl-cipher">nginx.ingress.kubernetes.io/ssl-cipher</a></td>
<td>域名</td>
<td>兼容</td>
<td>指定tls的加密套件，可以指定多个，英文逗号分隔，仅当tls握手时采用TLSv1.0-1.2生效。<br>默认加密套件如下：<br>- ECDHE-ECDSA-AES128-GCM-SHA256<br>- ECDHE-RSA-AES128-GCM-SHA256<br>- ECDHE-ECDSA-AES128-SHA<br>- ECDHE-RSA-AES128-SHA<br>- AES128-GCM-SHA256<br>- AES128-SHA<br>- ECDHE-ECDSA-AES256-GCM-SHA384<br>- ECDHE-RSA-AES256-GCM-SHA384<br>- ECDHE-ECDSA-AES256-SHA<br>- ECDHE-RSA-AES256-SHA<br>- AES256-GCM-SHA384<br>- AES256-SHA</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/auth-tls-secret">nginx.ingress.kubernetes.io/auth-tls-secret</a></td>
<td>域名</td>
<td>部分兼容。secret名字格式必须是：(该域名证书所在的secret的名字)-cacert</td>
<td>网关使用的CA证书，用于验证MTLS握手期间，客户端提供的证书。该注解主要应用于网关需要验证客户端身份的场景。</td>
</tr>
</tbody>
</table>
<h4>网关与后端服务之间通信加密</h4>
<table>
<thead>
<tr>
<th>注解</th>
<th>作用域</th>
<th>支持度</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/proxy-ssl-secret">nginx.ingress.kubernetes.io/proxy-ssl-secret</a></td>
<td>服务</td>
<td>兼容</td>
<td>网关使用的客户端证书，用于后端服务对网关进行身份认证</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/proxy-ssl-name">nginx.ingress.kubernetes.io/proxy-ssl-name</a></td>
<td>服务</td>
<td>兼容</td>
<td>TLS握手期间使用的SNI</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/proxy-ssl-server-name">nginx.ingress.kubernetes.io/proxy-ssl-server-name</a></td>
<td>服务</td>
<td>兼容</td>
<td>开启或关闭TLS握手期间使用SNI</td>
</tr>
</tbody>
</table>
<h4>安全认证</h4>
<h5>Basic</h5>
<table>
<thead>
<tr>
<th>注解</th>
<th>作用域</th>
<th>支持度</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/auth-type">nginx.ingress.kubernetes.io/auth-type</a></td>
<td>Ingress</td>
<td>部分兼容。暂只支持Basic。</td>
<td>认证类型</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/auth-secret">nginx.ingress.kubernetes.io/auth-secret</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>Secret名字，格式支持<namespace>/<name>，包含被授予能够访问该Ingress上定义的路由的访问权限的用户名和密码。</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/auth-secret-type">nginx.ingress.kubernetes.io/auth-secret-type</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>Secret内容格式。<br>- auth-file：data的key为auth；value为用户名和密码，多帐号回车分隔<br>- auth-map：data的key为用户名；value为密码</td>
</tr>
<tr>
<td><a href="http://nginx.ingress.kubernetes.io/auth-realm">nginx.ingress.kubernetes.io/auth-realm</a></td>
<td>Ingress</td>
<td>兼容</td>
<td>保护域。相同的保护域共享用户名和密码。</td>
</tr>
</tbody>
</table>
<h2>备注</h2>
<p>关于以上提到的Nginx Ingress Annotation的更多信息，请参阅官方文档（<a href="https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/#annotations">https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/#annotations</a>）。</p>
</div></section><footer class="footer-container"><div class="footer-body"><img src="//img.alicdn.com/imgextra/i2/O1CN01oNTGgE1lfW7oEPIzP_!!6000000004846-2-tps-960-290.png"/><p class="docsite-power">website powered by docsite</p><div class="cols-container"><div class="col col-12"><h3>愿景</h3><p>为用户提供一站式云原生网关解决方案.</p></div><div class="col col-6"><dl><dt>文档</dt><dd><a href="/zh-cn/docs/overview/what-is-higress.html" target="_self">Higress 是什么？</a></dd><dd><a href="/zh-cn/docs/user/quickstart.html" target="_self">快速开始</a></dd><dd><a href="https://github.com/higress-group/higress-group.github.io/issues/new" target="_self">报告文档问题</a></dd><dd><a href="https://github.com/higress-group/higress-group.github.io" target="_self">在Github上编辑此文档</a></dd></dl></div><div class="col col-6"><dl><dt>资源</dt><dd><a href="/zh-cn/blog/index.html" target="_self">博客</a></dd><dd><a href="/zh-cn/community/index.html" target="_self">社区</a></dd></dl></div></div><div class="copyright"><span>Copyright © 2022 Higress</span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script src="//g.alicdn.com/alilog/mlog/aplus_v2.js" id="beacon-aplus" exparams="clog=o&aplus&sidx=aplusSidx&ckx=aplusCkx"></script>
     <script src="//g.alicdn.com/aes/??tracker/1.0.34/index.js,tracker-plugin-pv/2.4.5/index.js,tracker-plugin-event/1.2.5/index.js,tracker-plugin-jserror/1.0.13/index.js,tracker-plugin-api/1.1.14/index.js,tracker-plugin-perf/1.1.8/index.js,tracker-plugin-eventTiming/1.0.4/index.js"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YHS75WKFBR"></script>
    <script>
		window.rootPath = '';
    </script>
	<script src="/build/documentation.js"></script>
	<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?4debd66ec73a32e236b30b46d219e2e3";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();

    window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-YHS75WKFBR');
    </script>
</body>
</html>
