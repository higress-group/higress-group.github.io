<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="Higress" />
	<meta name="description" content="测试覆盖率向导。" />
	<!-- 网页标签标题 -->
	<title>测试覆盖率向导</title>
  <link rel="shortcut icon" href="/img/higress_logo_small.png"/>
	<link rel="stylesheet" href="/build/documentation.css" />
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot=""><header class="header-container header-container-normal"><div class="header-body"><a href="/zh-cn/index.html"><img class="logo" src="//img.alicdn.com/imgextra/i1/O1CN015n2gG9211hXjnNPy3_!!6000000006925-2-tps-960-258.png"/></a><div class="search search-normal"><span class="icon-search"></span></div><span class="language-switch language-switch-normal">En</span><div class="header-menu"><img class="header-menu-toggle" src="https://img.alicdn.com/tfs/TB14eEmw7P2gK0jSZPxXXacQpXa-38-32.png"/><ul><li class="menu-item menu-item-normal"><span><a href="/zh-cn/index.html">首页</a></span></li><li class="menu-item menu-item-normal menu-item-normal-active"><span><a href="/zh-cn/docs/overview/what-is-higress.html">文档</a></span></li><li class="menu-item menu-item-normal"><div class="nav-container"><div class="word"><a>解决方案</a><img class="menu-img" src="https://img.alicdn.com/tfs/TB1esl_m.T1gK0jSZFrXXcNCXXa-200-200.png"/></div><ul class="sub-nav-container" style="width:220px"><li><a href="https://cn.aliyun.com/product/aliware/mse?spm=higress-website.topbar.0.0.0" target="_blank">分布式事务解决方案</a></li><li><a href="https://cn.aliyun.com/product/aliware/mse?spm=higress-website.topbar.0.0.0" target="_blank">微服务解决方案</a></li><li><a href="https://www.aliyun.com/product/ahas?spm=higress-website.topbar.0.0.0" target="_blank">高可用解决方案</a></li><li><a href="https://cn.aliyun.com/product/aliware/sae?spm=higress-website.topbar.0.0.0" target="_blank">微服务Serverless解决方案</a></li><li><a href="https://www.aliyun.com/product/edas?spm=higress-website.topbar.0.0.0" target="_blank">PaaS解决方案</a></li><li><a href="https://www.aliyun.com/product/servicemesh?spm=higress-website.topbar.0.0.0" target="_blank">服务网格解决方案</a></li></ul> </div></li><li class="menu-item menu-item-normal"><span><a href="/zh-cn/docs/developers/developers_dev.html">开发者</a></span></li><li class="menu-item menu-item-normal"><span><a href="/zh-cn/blog/index.html">博客</a></span></li><li class="menu-item menu-item-normal"><span><a href="/zh-cn/community/index.html">社区</a></span></li><li class="menu-item menu-item-normal"><span><a href="/zh-cn/blog/download.html">下载</a></span></li></ul></div></div></header><div class="bar"><div class="bar-body"><img src="https://img.alicdn.com/tfs/TB1cm8nJwDqK1RjSZSyXXaxEVXa-160-160.png" class="front-img"/><span>文档</span><img src="https://img.alicdn.com/tfs/TB1cm8nJwDqK1RjSZSyXXaxEVXa-160-160.png" class="back-img"/></div></div><section class="content-section"><div class="sidemenu"><div class="sidemenu-toggle"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png"/></div><ul><li class="menu-item menu-item-level-1"><span>概述</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/overview/what-is-higress.html" target="_self">Higress 是什么？</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/overview/terminology.html" target="_self">术语表</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/zh-cn/docs/overview/faq.html" target="_self">FAQ</a></li></ul></li></ul></div><div class="doc-content markdown-body"><h1>测试覆盖率向导</h1>
<h2>测试粒度如何划分</h2>
  <img src="https://microservices.io/i/test-pyramid.jpeg">
        测试粒度如何划分是个大问题。Chris Richardson 在" [降低测试金字塔：微服务的有效测试策略](https://microservices.io/microservices/testing/2019/09/20/oracle-code-one-testing.html)" 一文中将服务测试划分为：单元测试、集成测试、组件测试、端到端的测试。我们可以在设计测试用例的过程中,拿来借鉴。
<h2>单元测试</h2>
<h3>1.写单元测试的收益</h3>
<ul>
<li>单元测试能帮助每个人深入代码细节，了解代码的功能。</li>
<li>通过测试用例我们能发现bug，并提交代码的健壮性。</li>
<li>测试用例同时也是代码的demo用法。</li>
</ul>
<h3>2.单元测试用例的一些设计原则</h3>
<ul>
<li>应该精心设计好步骤，颗粒度和组合条件。</li>
<li>注意边界条件。</li>
<li>单元测试也应该好好设计，不要写无用的代码。</li>
<li>当你发现一个<code>方法</code>很难写单元测试时，如果可以确认这个<code>方法</code>是<code>臭代码</code>，那么就和开发者一起重构它。</li>
<li>Higress中用的mock框架是: <a href="http://site.mockito.org/">mockito</a>. 下面是一些开发向导:<a href="http://www.baeldung.com/bdd-mockito">mockito tutorial</a>,<a href="https://dzone.com/refcardz/mockito">mockito refcard</a></li>
<li>TDD（可选）：当你开始写一个新的功能时，你可以试着先写测试用例。</li>
</ul>
<h3>3.测试覆盖率设定值</h3>
<ul>
<li>在现阶段，Delta更改代码的测试覆盖设定值为：&gt;＝80%，越高越好。</li>
<li>我们可以在这个页面中看到测试报告: <a href="https://codecov.io/gh/alibaba/higress">https://codecov.io/gh/alibaba/higress</a></li>
</ul>
<h3>4.项目约定</h3>
<ul>
<li>Higress 项目的单元测试用例分布在项目每个子模块中，测试断言类以Test结尾。</li>
</ul>
<h2>集成测试</h2>
<h3>项目约定</h3>
<ul>
<li>集成测试在本项目泛指单元测试以上级别的测试。</li>
<li>项目使用<a href="https://help.github.com/cn/actions/automating-your-workflow-with-github-actions">github actions</a>、<a href="https://github.com/GoogleContainerTools/jib">jiblib maven 插件</a>、<a href="https://github.com/fabric8io/fabric8-maven-plugin">fabric maven 插件</a>、<a href="https://github.com/testcontainers/testcontainers-java">testContainers</a>等用来构建<a href="https://www.docker.com/">Docker</a>镜像，搭建集成测试环境</li>
<li>区别于单元测试，某个测试用例，需要依赖第三方中间件的，可以不用Mock, 使用上面介绍的工具搭建docker环境,进行测试。但是也要注意搭建组件的粒度。过于复杂的环境，可以：核心测试依赖的中间件可以docker搭建，非强依赖的可以Mock</li>
<li>Higress 项目的集成测试用例分布统一放在integration-test子模块中，测试断言类以IT结尾。</li>
<li>这里还用 <a href="https://junit.org/junit5/">Junit5</a></li>
<li>测试用例并行跑的过程中，注意公共中间件的隔离状态，规划好所造数据，防止冲突。</li>
</ul>
</div></section><footer class="footer-container"><div class="footer-body"><img src="//img.alicdn.com/imgextra/i3/O1CN018Uhbjp1e3mAzv0Lt2_!!6000000003816-2-tps-961-258.png"/><p class="docsite-power">website powered by docsite</p><div class="cols-container"><div class="col col-12"><h3>愿景</h3><p>Higress 是...</p></div><div class="col col-6"><dl><dt>文档</dt><dd><a href="/zh-cn/docs/overview/what-is-higress.html" target="_self">Higress 是什么？</a></dd><dd><a href="/zh-cn/docs/user/quickstart.html" target="_self">快速开始</a></dd><dd><a href="https://github.com/higress-group/higress-group.github.io/issues/new" target="_self">报告文档问题</a></dd><dd><a href="https://github.com/higress-group/higress-group.github.io" target="_self">在Github上编辑此文档</a></dd></dl></div><div class="col col-6"><dl><dt>资源</dt><dd><a href="/zh-cn/blog/index.html" target="_self">博客</a></dd><dd><a href="/zh-cn/community/index.html" target="_self">社区</a></dd></dl></div></div><div class="copyright"><span>Copyright © 2022 Higress</span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-X4LJGF90X2"></script>
	<script>
		window.rootPath = '';
  </script>
	<script src="/build/documentation.js"></script>
	<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?104e73ef0c18b416b27abb23757ed8ee";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();

    window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-X4LJGF90X2');
    </script>
</body>
</html>
